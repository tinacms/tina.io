---
seo:
  description: >-
    ä½¿ç”¨Next.js Pages Routerè®¾ç½®TinaCMSã€‚äº†è§£é…ç½®æ­¥éª¤ã€æœ€ä½³å®è·µä»¥åŠå¦‚ä½•å®ç°æµç•…çš„ç¼–è¾‘ä½“éªŒã€‚
title: Next.js Pages Router
last_edited: '2025-03-27T01:38:32.349Z'
next: content/docs-zh/frameworks/astro.mdx
previous: content/docs-zh/frameworks/next/app-router.mdx
---

> â˜ï¸ æœ¬æŒ‡å—å‡è®¾æ‚¨æ­£åœ¨ä½¿ç”¨ **Next.js pages router**ã€‚

## è§†é¢‘æŒ‡å—

<Youtube embedSrc="https://www.youtube.com/embed/0oYSzT1DDLg" />

## å®‰è£…ä¾èµ–

åœ¨æ‚¨ç½‘ç«™çš„ç›®å½•ä¸­è¿è¡Œï¼š

```bash
npx @tinacms/cli@latest init
```

è¿™å°†è¯¢é—®æ‚¨ä¸€äº›è®¾ç½®é—®é¢˜ã€‚å½“æç¤ºè¾“å…¥ **å…¬å…±èµ„äº§ç›®å½•** æ—¶ï¼Œè¾“å…¥ï¼š**public**ã€‚

## æ›´æ–°æ„å»ºè„šæœ¬

`tina init` åº”è¯¥å·²ç»æ›´æ–°äº†æ‚¨çš„ `package.json` è„šæœ¬ã€‚

```javascript
"scripts": {
  "dev": "tinacms dev -c \"next dev\"",
  "build": "tinacms build && next build",
  "start": "tinacms build && next start"
}
```

å¦‚æœè¿™äº›æ²¡æœ‰è¢«CLIè®¾ç½®ï¼Œæ‚¨éœ€è¦æ‰‹åŠ¨åº”ç”¨ã€‚

## å¯åŠ¨TinaCMS

æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤å¯åŠ¨TinaCMSï¼š

```bash
pnpm dev
```

**æˆ‘ä»¬æ¨èä½¿ç”¨pnpmã€‚**

åœ¨TinaCMSè¿è¡Œæ—¶ï¼Œå¯¼èˆªåˆ° `http://localhost:3000/admin/index.html`ã€‚

> â“ æç¤ºï¼šå¦‚æœè¿è¡Œæ­¤å‘½ä»¤æ—¶å‡ºç°é”™è¯¯ï¼Œè¯·å‚é˜…[å¸¸è§é”™è¯¯](/docs/forestry/common-errors)é¡µé¢ã€‚

æ­¤æ—¶ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿçœ‹åˆ°Tinaç®¡ç†ç•Œé¢ï¼Œé€‰æ‹©ä¸€ä¸ªå¸–å­ï¼Œä¿å­˜æ›´æ”¹ï¼Œå¹¶çœ‹åˆ°æ›´æ”¹å·²æŒä¹…åŒ–åˆ°æ‚¨çš„æœ¬åœ°markdownæ–‡ä»¶ä¸­ã€‚

![TinaCMS ç®¡ç†ç•Œé¢æˆªå›¾](/img/hugo-tina-admin-screenshot.png)

## TinaCMS é…ç½®æ–‡ä»¶

è¿è¡Œ `tina init` å‘½ä»¤åï¼Œåˆ›å»ºäº†ä¸€äº›æ–‡ä»¶ä»¥å¸®åŠ©æ‚¨å¿«é€Ÿå…¥é—¨ã€‚å…¶ä¸­ä¹‹ä¸€æ˜¯ `tina/config.ts` æ–‡ä»¶ã€‚è¿™æ˜¯ä¸€ä¸ªå¿…éœ€çš„é…ç½®æ–‡ä»¶ï¼Œå®šä¹‰äº†æ‰€æœ‰çš„tinaæ¨¡å¼ã€‚

å®ƒçœ‹èµ·æ¥å¦‚ä¸‹ï¼š

```ts
import { defineConfig } from 'tinacms'

// æ‚¨çš„æ‰˜ç®¡æœåŠ¡æä¾›å•†å¯èƒ½å°†å…¶ä½œä¸ºç¯å¢ƒå˜é‡å…¬å¼€
const branch =
  process.env.GITHUB_BRANCH ||
  process.env.VERCEL_GIT_COMMIT_REF ||
  process.env.HEAD ||
  'main'

export default defineConfig({
  branch,

  // ä»tina.ioè·å–
  clientId: process.env.NEXT_PUBLIC_TINA_CLIENT_ID,
  // ä»tina.ioè·å–
  token: process.env.TINA_TOKEN,

  build: {
    outputFolder: 'admin',
    publicFolder: 'public',
  },
  media: {
    tina: {
      mediaRoot: '',
      publicFolder: 'public',
    },
  },
  schema: {
    collections: [
      {
        name: 'post',
        label: 'Posts',
        path: 'content/posts',
        fields: [
          {
            type: 'string',
            name: 'title',
            label: 'Title',
            isTitle: true,
            required: true,
          },
          {
            type: 'rich-text',
            name: 'body',
            label: 'Body',
            isBody: true,
          },
        ],
      },
    ],
  },
})
```

**æœ‰å…³é…ç½®çš„æ›´è¯¦ç»†æ¦‚è¿°ï¼Œè¯·å‚é˜…[TinaCMSå†…å®¹å»ºæ¨¡](/docs/extending-tina/overview/)**

> ğŸ’¡ å¦‚æœæ‚¨æŒ‰ç…§æœ¬æŒ‡å—ä½¿ç”¨ `tina init` å‘½ä»¤ï¼Œæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°åˆ›å»ºäº†ä¸€ä¸ª `content` å’Œä¸€ä¸ª `pages` æ–‡ä»¶å¤¹ï¼š

```bash
 Adding file at content/posts/hello-world.md... âœ…
 Adding file at pages/demo/blog/[filename].tsx... âœ…
```

> è¿™äº›å¯ä»¥ç”¨ä½œå¿«é€Ÿå‚è€ƒï¼Œä½†å¯ä»¥å®‰å…¨åˆ é™¤ã€‚

## åˆ›å»ºæ–°å¸–å­

> ğŸ’¡ å¦‚ `tina/config.ts` æ–‡ä»¶ä¸­å®šä¹‰çš„ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªåä¸º `post` çš„é›†åˆï¼Œå®ƒå°†è¢«TinaCMSæ‹¾å–å¹¶æ˜ å°„åˆ°æ‚¨åœ¨TinaCMSç®¡ç†é¡µé¢ä¸­çœ‹åˆ°çš„å†…å®¹ã€‚

1. å‰å¾€ `/admin/index.html`

2. ç‚¹å‡» Posts

3. ç‚¹å‡» Create

4. è¾“å…¥å¿…å¡«å­—æ®µ

5. ä¿å­˜

ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›å»æ£€æŸ¥åˆ›å»ºäº†ä»€ä¹ˆã€‚æ‚¨å°†çœ‹åˆ°ä¸€ä¸ª `/content` æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­ä¿å­˜äº†æ‚¨çš„æ–°å¸–å­ä½œä¸º `.md` æ–‡ä»¶ã€‚æ­¤è·¯å¾„åœ¨ `tina/config.ts` æ–‡ä»¶çš„posté›†åˆä¸­å®šä¹‰ï¼

```bash
content
    â””â”€â”€ posts
        â””â”€â”€ hello-world.md
```

## æ¸²æŸ“å¸–å­é›†åˆ

è®©æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ª `/posts` æ–‡ä»¶å¤¹å¼€å§‹ã€‚è¿™é‡Œçš„ç´¢å¼•å°†åˆ—å‡ºæˆ‘ä»¬æ‰€æœ‰çš„å¸–å­ã€‚

**æ–‡ä»¶ï¼š** `pages/posts/index.tsx`

```tsx
import Link from 'next/link'
import { useTina } from 'tinacms/dist/react'
import { client } from '../../tina/__generated__/client'

export default function PostList(props) {
  // æ•°æ®åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹ä¼ é€’ï¼Œå¹¶åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹æ›´æ–°ä¸ºä¾§è¾¹æ æ•°æ®
  const { data } = useTina({
    query: props.query,
    variables: props.variables,
    data: props.data,
  })
  const postsList = data.postConnection.edges
  return (
    <>
      <h1>Posts</h1>
      <div>
        {postsList.map((post) => (
          <div key={post.node.id}>
            <Link href={`/posts/${post.node._sys.filename}`}>
              {post.node._sys.filename}
            </Link>
          </div>
        ))}
      </div>
    </>
  )
}

export const getStaticProps = async () => {
  const { data, query, variables } = await client.queries.postConnection()

  return {
    props: {
      data,
      query,
      variables,
    },
  }
}
```

## æ¸²æŸ“å•ä¸ªå¸–å­

**æ–‡ä»¶ï¼š** `pages/posts/[slug].tsx`

```tsx
import { useTina } from 'tinacms/dist/react'
import { client } from '../../tina/__generated__/client'

export default function Home(props) {
  // æ•°æ®åœ¨ç”Ÿäº§æ¨¡å¼ä¸‹ä¼ é€’ï¼Œå¹¶åœ¨ç¼–è¾‘æ¨¡å¼ä¸‹æ›´æ–°ä¸ºä¾§è¾¹æ æ•°æ®
  const { data } = useTina({
    query: props.query,
    variables: props.variables,
    data: props.data,
  })

  return (
    <>
      <code>
        <pre
          style={{
            backgroundColor: 'lightgray',
          }}
        >
          {JSON.stringify(data.post, null, 2)}
        </pre>
      </code>
    </>
  )
}

export const getStaticPaths = async () => {
  const { data } = await client.queries.postConnection()
  const paths = data.postConnection.edges.map((x) => {
    return { params: { slug: x.node._sys.filename } }
  })

  return {
    paths,
    fallback: 'blocking',
  }
}

export const getStaticProps = async (ctx) => {
  const { data, query, variables } = await client.queries.post({
    relativePath: ctx.params.slug + '.md',
  })

  return {
    props: {
      data,
      query,
      variables,
    },
  }
}
```

## ä¸‹ä¸€æ­¥

* [æŸ¥çœ‹å†…å®¹å»ºæ¨¡æ–‡æ¡£](/docs/schema/)
* [äº†è§£å¦‚ä½•æŸ¥è¯¢æ‚¨çš„å†…å®¹](/docs/features/data-fetching/)
* [éƒ¨ç½²æ‚¨çš„ç½‘ç«™](/docs/tina-cloud)