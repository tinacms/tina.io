---
id: /docs/reference/config/
title: 配置参考
alias: the-config-file
last_edited: '2025-12-09T23:01:02.997Z'
tocIsHidden: false
next: content/docs-zh/reference/schema.mdx
previous: content/docs-zh/reference/overview.mdx
---

从 `tina/config.{ts,tsx,js,jsx}` 导出的 `defineConfig` 函数的结果定义了你的 TinaCMS 设置。

<WarningCallout
  body={<>
    重要 - 配置必须是确定性的
    
    defineConfig 返回的对象在开发和构建期间必须多次评估。避免在影响模式或运行时配置的配置属性中直接使用非确定性值（例如 Date.now(), Math.random()）。这可能导致 GraphQL 模式不匹配错误。
    
    如果需要动态值，请返回一个函数并延迟计算该值。
  </>}
/>

请注意，它**必须是**默认导出。

> 配置文件的位置以前在 `.tina/config.{ts,tsx,js,jsx}`

## 选项

<apiReference
  title=""
  property={[
    {
      groupName: "",
      name: "schema",
      type: "Schema",
      description: "定义你的**内容模型**。\n",
      required: true
    },
    {
      groupName: "build",
      name: "publicFolder",
      type: "string",
      required: true,
      description: '应用程序资产文件夹路径。\n\n通常为 `"public"`。\n'
    },
    {
      groupName: "build",
      name: "outputFolder",
      type: "string",
      required: true,
      description:
        'TinaCMS 构建路径（编辑器路由）。\n\n通常为 `"admin"`。\n\n这将在 `[url]/admin/index.html` 查看。\n'
    },
    {
      groupName: "build",
      name: "host",
      type: "string | boolean",
      description: "vite 配置的主机选项。\n"
    },
    {
      groupName: "build",
      name: "basePath",
      type: "string",
      description:
        '如果在子路径上提供服务，请设置。\n\n对于 `[url]/my-site`，设置为 `"my-site"`。\n'
    },
    {
      groupName: "server",
      name: "allowedOrigins",
      type: "(string | RegExp | 'private')[]",
      description:
        "控制哪些网站可以与本地开发服务器通信。仅影响 `tinacms dev` — 在生产中无效。\n\n默认情况下，仅允许来自您自己机器（`localhost`）的请求。只有在您在远程环境中开发时才需要设置此项，例如 **GitHub Codespaces**、**Gitpod**、**Docker** 或 **WSL2**。\n\n每个条目可以是：\n\n- 一个 **URL 字符串** — 例如 `'https://my-codespace.github.dev'`\n- 一个 **RegExp** — 用于匹配 URL 模式\n- `'private'` — 一个允许本地网络上任何设备的简写，即 RFC 1918 私有 IP 范围（对 Docker 或 WSL2 有用）\n\n```ts\nserver: {\n  allowedOrigins: ['private', 'https://my-codespace.github.dev']\n}\n```\n"
    },
    {
      groupName: "",
      name: "branch",
      type: "string | null",
      description:
        "要从中提取内容的基本分支。对于 **TinaCloud** 是必需的。\n"
    },
    {
      groupName: "",
      name: "clientId",
      type: "string | null",
      description: "来自 TinaCloud 的 `clientId`。对于 **TinaCloud** 是必需的。\n"
    },
    {
      groupName: "",
      name: "token",
      type: "string | null",
      description:
        "来自 TinaCloud 的只读令牌。对于 **TinaCloud** 是必需的。\n"
    },
    {
      groupName: "",
      name: "localContentPath",
      type: "string",
      description:
        "用于本地开发的单独内容仓库的路径，**相对于 `tina/` 配置文件夹解析**（而不是项目根目录）。\n\n设置后，集合 `path` 值相对于此内容根目录解析。内容目录**必须包含一个 `tina/` 文件夹**（可以为空）— TinaCMS 会在其中写入生成的文件，如 `tina-lock.json`。\n\n使用环境变量，因为路径可能因开发人员而异：\n\n```ts\nlocalContentPath: process.env.TINA_CONTENT_REPO_PATH // 例如 '../../my-content-repo'\n```\n\n有关完整的设置详细信息，请参阅 [单独的内容仓库指南](/docs/guides/separate-content-repo)。\n"
    },
    {
      groupName: "",
      name: "authProvider",
      type: "AuthProvider",
      description:
        "设置 [自定义身份验证](/docs/reference/self-hosted/auth-provider/overview)。\n"
    },
    {
      groupName: "admin",
      name: "authHooks",
      type: "AuthHooks",
      description: "用于在身份验证事件上运行逻辑。\n"
    },
    {
      description:
        "选择退出更新检查 - 这将阻止 CMS 检查新版本。如果为 true，CMS 将不检查更新。\n",
      groupName: "ui",
      name: "optOutOfUpdateCheck",
      type: "boolean",
      default: "false"
    },
    {
      groupName: "ui",
      name: "previewUrl",
      type: "function -- context: { branch: string } => { url: string }",
      description:
        "识别特定分支的 URL 模式，例如用于预览部署，并通过编辑器链接到它们。\n\n![](/img/docs/share-btn_xvmxii.png)\n",
      required: false
    },
    {
      description:
        '新建文件夹时，文件夹名称必须匹配的正则表达式模式。仅适用于新创建的文件夹，不适用于现有文件夹。\n\n例如： "^\\[a-z0-9-]+$" 用于小写字母、数字和连字符\n',
      groupName: "ui",
      name: "regexValidation.folderNameRegex",
      type: "string"
    },
    {
      groupName: "client",
      name: "skip",
      type: "boolean",
      description: "跳过构建自动生成的 GraphQL 客户端。\n"
    },
    {
      groupName: "client",
      name: "referenceDepth",
      type: "number",
      description:
        "生成的查询将遍历引用到给定的深度。\n",
      default: "2"
    },
    {
      groupName: "client",
      name: "errorPolicy",
      type: "'throw' | 'include'",
      description:
        "设置客户端错误处理。'throw' 将在查询失败时抛出错误，'include' 将在查询响应中返回错误。\n",
      default: "throw"
    },
    {
      groupName: "media",
      name: "loadCustomStore",
      type: "() => Promise<Store>",
      description:
        "加载自定义媒体存储，如 Cloudinary。\n\n**要么设置此属性，要么设置** `media.tina` **对象，不能同时设置。**\n"
    },
    {
      groupName: "media",
      name: "accept",
      type: "string | string[]",
      description:
        '允许的媒体类型。\n\n例如 `["image/png", "image/jpeg"]` 或 `"image/*"`。\n'
    },
    {
      groupName: "media.tina",
      name: "publicFolder",
      type: "string",
      description: "你的资产文件路径。\n"
    },
    {
      groupName: "media.tina",
      name: "mediaRoot",
      description:
        "媒体的根文件夹（公共文件夹的子目录）。\n",
      type: "string"
    },
    {
      groupName: "media.tina",
      name: "static",
      description: "指示编辑者是否可以管理媒体。\n",
      default: "false",
      type: "boolean"
    },
    {
      groupName: "search",
      name: "indexBatchSize",
      type: "number",
      description: "每个 PUT 请求要索引的文档数量。\n"
    },
    {
      groupName: "search",
      name: "maxSearchIndexFieldLength",
      type: "number",
      description:
        "将被索引用于搜索的字符串字段的最大长度。\n"
    },
    {
      groupName: "search",
      name: "searchClient",
      type: "SearchClient",
      description:
        "自定义搜索客户端的实例，如 Algolia。\n\n**要么设置此属性，要么设置** `search.tina` **对象，不能同时设置。**\n"
    },
    {
      groupName: "search.tina",
      name: "indexerToken",
      type: "string",
      description:
        "具有写入搜索索引权限的搜索索引令牌。仅由 CLI 使用。\n"
    },
    {
      groupName: "search.tina",
      name: "stopwordLanguages",
      type: "string[]",
      description: "要使用的停用词语言。\n",
      default: '["eng"]'
    },
    {
      groupName: "search.tina",
      name: "tokenSplitRegex",
      type: "string",
      description: "用于拆分标记的正则表达式。\n",
      default: "/[\\p{L}\\d_]+/"
    },
    {
      groupName: "search.tina",
      name: "fuzzyEnabled",
      type: "boolean",
      description: "启用后，即使查询中有小错误或拼写差异，搜索也会返回结果。\n",
      default: "true"
    },
    {
      groupName: "search.tina",
      name: "fuzzyOptions.maxDistance",
      type: "number",
      description: "一个单词与搜索词之间可以有多少字符更改（插入、删除、替换）仍然算作匹配。较高的值会返回更多结果，但可能不太相关。\n",
      default: "2"
    },
    {
      groupName: "search.tina",
      name: "fuzzyOptions.minSimilarity",
      type: "number",
      description:
        "结果与搜索词的相似度必须达到的阈值，范围在 0 到 1 之间。提高此值以仅显示非常接近的匹配项；降低它以更宽松。\n",
      default: "0.6"
    },
    {
      groupName: "search.tina",
      name: "fuzzyOptions.maxTermExpansions",
      type: "number",
      description:
        "搜索引擎为每个搜索词考虑的相似词的最大数量。较高的值可以提高召回率，但可能会减慢搜索速度。\n",
      default: "10"
    },
    {
      groupName: "search.tina",
      name: "fuzzyOptions.useTranspositions",
      type: "boolean",
      description:
        "启用后，交换字符（例如输入 \"teh\" 而不是 \"the\"）算作单个编辑而不是两个，使搜索对常见拼写错误更宽容。\n",
      default: "true"
    },
    {
      description:
        "defaultBranchName 用于在本地解析 `historyUrl` 时覆盖本地分支。主要用例是当默认分支不叫 `main` 时\n",
      groupName: "repoProvider",
      name: "defaultBranchName",
      type: "string"
    },
    {
      description:
        "允许用户定义 TinaCMS 应该链接用户以查看他们正在编辑的文件的源历史记录的位置。\n\n`branch` 由 TinaCMS 为活动编辑分支解析\n\n`relativePath` 由 TinaCMS 为相关内容文件的相对路径解析\n\nGitHub 示例：\n\n```\nhistoryUrl: ({ relativePath, branch }) => ({ \n  url: `https://github.com/tinacms/tina.io/commits/${branch}/${relativePath}`\n```\n",
      groupName: "repoProvider",
      name: "historyUrl",
      type: "function -- historyUrl?: (context: { relativePath: string; branch: string;}) => { url: string }"
    },
    {
      groupName: "",
      name: "contentApiUrlOverride",
      type: "string",
      description: "覆盖默认内容 API URL。\n",
      experimental: true
    },
    {
      groupName: "",
      name: "telemetry",
      type: "'anonymous' | 'disabled'",
      description:
        "控制 TinaCMS 是否收集匿名使用统计数据以帮助改进产品。\n\n设置为 `'disabled'` 以完全选择退出。\n",
      default: "'anonymous'"
    }
  ]}
/>

## 示例

### Vercel 和 TinaCloud 配置

这是一个使用 TinaCloud 托管数据层和内置 Tina 媒体及搜索功能的标准配置。

```ts
const branch =
  process.env.NEXT_PUBLIC_TINA_BRANCH ||
  process.env.NEXT_PUBLIC_VERCEL_GIT_COMMIT_REF ||
  process.env.HEAD ||
  'main';

export default defineConfig({
  branch,
  // 由 TinaCloud 生成
  token: '<Your Read Only Token>',
  // 由 TinaCloud 生成
  clientId: '<Your Client ID>',
  build: {
    publicFolder: 'public',
    outputFolder: 'admin',
  },
  schema: {
    //内容模型定义在这里...
  },
  ui: {
    previewUrl: (context) => {
      // 根据分支名称使用 Vercel 预览部署
      return { url: `https://my-app-git-${context.branch}.vercel.app` };
    },
  },
  media: {
    tina: {
      publicFolder: 'public',
      mediaRoot: 'uploads',
    },
  },
  search: {
    tina: {
      indexerToken: process.env.TINA_SEARCH_TOKEN,
    },
  },
});
```

### Cloudinary 媒体存储

Tina 支持 Git 支持的媒体和特定的外部媒体提供商：

```ts
export default defineConfig({
  // ... 其他配置选项
  media: {
    loadCustomStore: async () => {
      const pack = await import('next-tinacms-cloudinary');
      return pack.TinaCloudCloudinaryMediaStore;
    },
    accept: 'image/*',
  },
});
```

### TinaCloud 搜索选项

Tina 提供通过 TinaCloud 的内置搜索功能。

```ts
// Tina Cloud 搜索
export default defineConfig({
  // ... 其他配置选项
  search: {
    tina: {
      indexerToken: process.env.TINA_SEARCH_TOKEN,
      stopwordLanguages: ['eng', 'fra'],
      tokenSplitRegex: '/[p{L}d_]+/',
    },
  },
});
```

### 使用 TypeScript 路径别名的导入

TinaCMS 支持在 `tina/config.{ts,js,tsx}` 文件和集合中使用 TypeScript 路径别名。

确保 `tsconfig.json` 存在于项目的根目录。 在 `compilerOptions` 部分定义你的别名。

```javascript
//tsconfig.json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"]
    }
  }
}
```

你现在可以使用别名导入实用程序或其他模块。

```typescript
import { someUtility } from '@/lib/utils';

export default defineConfig({
  //...
});
```