---
title: 使用GitHub Actions审核内容
last_edited: '2025-12-12T06:55:00.463Z'
next: ''
previous: ''
---

> 注意：这仍在进行中，目前功能可用，但我们正在努力简化它。请在[这里](https://github.com/tinacms/tinacms/issues/6156)关注更新。

## 概述

随着您的网站内容开始扩展，保持旧内容的更新可能会变得困难。

本指南包含设置GitHub Actions工作流的说明，以使用AI检查过时内容并提出GitHub问题。

![](/img/docs/content-audit-github-actions/audit-issue-description.png)

<scrollBasedShowcase
  showcaseItems={[
    {
      title: "Tina Cloud",
      image: "",
      content:
        "您的内容将在Tina Cloud中查询。这为GitHub操作提供了需要定位的文件列表。\n",
      useAsSubsection: false
    },
    {
      title: "GitHub Actions",
      image: "",
      content:
        "GitHub操作将使用来自TinaCloud的响应在您的存储库中定位正确的文件。从那里开始，将读取每个文件的内容以进行审查。\n",
      useAsSubsection: false
    },
    {
      title: "问题",
      image: "",
      content:
        "在扫描您的内容后，GitHub操作将生成一个问题列表，并根据您的系统提示提出改进建议。\n",
      useAsSubsection: true
    },
    {
      title: "拉取请求",
      image: "",
      content:
        "GitHub操作将自动创建包含已检查文件列表的拉取请求。\n",
      useAsSubsection: true
    },
    {
      title: "GitHub模型",
      image: "",
      content:
        "GitHub模型将读取并评估您的内容，标记任何潜在的改进区域。\n",
      useAsSubsection: false
    }
  ]}
/>

## 安装GitHub操作

我们有一个公共仓库，其中包含一个您可以直接使用的GitHub操作来审核您的内容。按照[安装步骤](https://github.com/tinacms/github-content-auditor?tab=readme-ov-file#how-to-install)进行设置。

## 配置您的仓库

### **权限**

#### 启用GitHub Actions的权限

1. 前往：**您的仓库 | ⚙️ 设置 | Actions | 常规 | 工作流权限**
2. 启用您仓库内工作流的读取权限
3. 允许GitHub Actions创建和批准拉取请求

![GitHub上的工作流权限设置](/img/docs/content-audit-github-actions/workflow-settings-github.png "GitHub上的工作流权限设置")

为您的仓库启用GitHub模型：

1. 前往：**您的仓库 | ⚙️设置 | 模型**
2. 确保您已为您的仓库启用模型

![为您的仓库启用GitHub模型](/img/docs/content-audit-github-actions/github-models-settings.png "为您的仓库启用GitHub模型")

### 变量

您需要添加在运行GitHub操作时将使用的配置设置。要配置设置，请前往**您的仓库 | ⚙️设置 | 秘密和变量。**

#### 秘密

| 名称                 | 描述                                                                                                                              |
| -------------------- | ---------------------------------------------------------------------------------------------------------------------------------------- |
| **TINA\_TOKEN**      | 您的TinaCloud API令牌。**TinaCloud \| \<your-project> \| Tokens \| Content (Readonly)**                                               |
| **TINA\_CLIENT\_ID** | 您项目的Tina客户端ID。您可以在**TinaCloud \| Projects \| \<your-project> \|  ⚙️ 项目详情 \| 客户端ID**中找到它 |

#### 变量

| 名称                                         | 描述                                                                                           |
| -------------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| **TINA\_AUDITOR\_CONTENT\_WINDOW**           | 一个数字，表示运行操作时将检查多少过时的内容项。（例如：5） |
| **TINA\_AUDITOR\_EXPIRY\_DAYS**              | 在您的内容被重新评估之前将经过的天数。                 |
| **TINA\_AUDITOR\_SYSTEM\_PROMPT (可选)**     | 将内容传递给GitHub模型时用于评估内容的提示。                |
| **TINA\_AUDITOR\_COLLECTION**                | 审核查询将针对的集合。                                                   |

#### 系统提示（可选）

您可以选择通过提供自己的GitHub变量来覆盖默认的系统提示。要覆盖的值是`TINA_AUDITOR_SYSTEM_PROMPT`。

默认的系统提示如下：

```plaintext
您是一名专家内容审核员。您的任务是审查提供的Markdown内容，并对其质量、清晰度、相关性和吸引力提供建设性反馈。您应突出并建议具体的改进区域。忽略lastChecked日期。
```

## 准备您的内容

TinaCloud将用于定位和过滤您的内容。我们需要在您选择的集合中添加几个字段以启用内容检查。

```tsx
const MyCollection : Collection = {
  label: '我的集合'
  name: 'myCollection'
  format: 'mdx'
  fields: [
    // 新字段
    {
      type: 'datetime',
      name: 'lastChecked',
      ui: {
        component: 'hidden',
      }
    },
    //...
  ]

}

```

> 在添加新字段后，请确保重新生成并提交您的`tina-lock.json`。

为了运行脚本，我们需要为您所有现有内容添加一个`lastChecked`字段。

导航到工作流的目录。

```bash
cd ./github/scripts/tina-helpers
```

您需要在此位置添加一个`.env`文件，并保存您的**Collection**、**Tina Token**和**Tina Client ID**。这些是您在[GitHub设置](/docs/guides/content-auditing-github-actions#secrets)中添加的相同属性。

```env
TINA_TOKEN=<your-tina-token>
TINA_CLIENT_ID=<your-tina-client-id>
TINA_AUDITOR_COLLECTION=<your-tina-collection>
```

然后运行以下命令以迁移您的内容。

```bash
pnpm install
pnpm run migrate-content
```

输出应如下所示：

```bash
updated: content/posts/future-of-remote-work-2025.mdx 
updated: content/posts/learning-about-components.mdx 
updated: content/posts/june/learning-about-tinacloud.mdx 
updated: content/posts/artificial-intelligence-explained.mdx 


```

<WarningCallout
  body={<>
    您必须提交并推送更新的文件以使GitHub操作正常工作。更改应在TinaCloud中。
  </>}
/>

## 运行查询

一旦您完成了为自己的项目设置GitHub操作，您应该能够在您的仓库的GitHub Actions中看到一个名为**使用AI审核内容**的新工作流。运行它以执行您的第一次内容审核。

![在GitHub Actions中运行内容审核](/img/docs/content-audit-github-actions/running-github-action.gif "在GitHub Actions中运行内容审核")

流程将在内容审核完成后输出一个问题列表。每个问题将包含内容的建议列表以及需要更改的文件的便捷链接。![](/img/docs/content-audit-github-actions/issues-audit-action.png "运行内容审核操作后的问题列表")
工作流还将输出一个拉取请求，以更新每个已审核文件的`lastChecked`日期。

![更新了最后检查日期的拉取请求](/img/docs/content-audit-github-actions/content-audit-pr.png "更新了最后检查日期的拉取请求")

<WarningCallout
  body={<>
    在再次运行GitHub操作之前，务必合并此拉取请求。否则，当您重新运行它时，它将再次审核相同的文件。
  </>}
/>

## 建议：将问题分配给Copilot

现在您有了一组从工作流生成的问题，您有几种选择来处理反馈。您可以自己处理这些问题，或者通过将问题分配给GitHub Copilot来完全自动化这个过程！