---
title: 'Setup Guide: Audit Content GitHub Action'
last_edited: '2025-12-09T23:11:11.730Z'
next: ''
previous: ''
---

## Overview

This workflow fetches content paths from TinaCMS, generates feedback issues, updates lastChecked in markdown files, and opens a PR.

![](/img/docs/content-audit-github-actions/CleanShot%202025-12-09%20at%2016.35.50.png)

<scrollBasedShowcase
  showcaseItems={[
    {
      title: "Tina Cloud",
      image: "",
      content:
        "The GraphQL query you run pass will be evaluated inside of TinaCloud. This supplies the GitHub action with the list of files it will need to locate and update.\n",
      useAsSubsection: false
    },
    {
      title: "GitHub Actions",
      image: "",
      content:
        "The GitHub actions will use the response from TinaCloud to locate the correct files within your repository.\n",
      useAsSubsection: false
    },
    {
      title: "Pull Requests",
      image: "",
      content:
        "The GitHub action will automatically create Pull Requests with the list of files that were checked. It's important that you merge these requests before re-running the action, otherwise the content checker will evaluate them again.\n",
      useAsSubsection: true
    },
    {
      title: "Issues",
      image: "",
      content:
        "The GitHub Action will check out your repository, scan the content returned from TinaCloud, and create Issues with suggestions based on your feedback.\n",
      useAsSubsection: true
    },
    {
      title: "GitHub Models",
      image: "",
      content:
        "Used to read and evaluate your content using the System prompt provided. This uses **Mistral 3B** by default.\n",
      useAsSubsection: false
    }
  ]}
/>

## Installing the GitHub action

We have a our own repo containing the GitHub action. Follow the [installation steps](https://github.com/tinacms/github-content-auditor?tab=readme-ov-file#how-to-install) to set the action up on your repo.

## Configuring your Repo

### **Permissions**

Enable the appropriate permissions for GitHub Actions

1. Go to: **Your Repository > ⚙️ Settings > Actions > General > Workflow Permisions**
2. Enable read permissions for workflows within your repository
3. Allow GitHub Actions to create and approve pull requests

Enable GitHub Actions for the organization.

1. Go to: **Your Repository  > ⚙️Settings > Models**
2. Ensure you have Models enabled for your repostory

### Secrets

| Variable             | Source                              |
| -------------------- | ----------------------------------- |
| **TINA\_TOKEN**      | Your TinaCloud API Token            |
| **TINA\_CLIENT\_ID** | The Tina Client ID for your project |

### Variables

| Secret                             | Description                                                                                           |
| ---------------------------------- | ----------------------------------------------------------------------------------------------------- |
| **TINA\_AUDITOR\_CONTENT\_WINDOW** | A number indicating how many outdated content items will be checked when you run the action. (i.e. 5) |
| **TINA\_AUDITOR\_EXPIRY\_DAYS**    | The number of days that will pass before your content is re-evaluated after already being checked.    |
| **TINA\_AUDITOR\_SYSTEM\_PROMPT**  | The prompt that will be used to evaluate your content when passing it to GitHub model.                |
| **TINA\_AUDITOR\_QUERY**           | The query that will be used to find the content within your repo.                                     |

### Adding your Query

The query you supply as **TINA\_CONTENT\_QUERY** must be a connection type. For more information about connection queries please consult the [documentation](https://tina.io/docs/graphql/queries/query-documents). Note that query need only return `_sys.path` and accept the `$first` and `$filter` properties. The 2 filters will be supplied when the action is run and the path property will be used to locate your content.

```graphql
# Replace with your connetion
query <your-connection>($first: Float, $filter: <your-connection-filter>) {
	<your-connection>(first: $first, filter: $filter) {
		edges {
			cursor
			node {
				... on Document {
					_sys {
						path
					}
				}
			}
		}
	}
}
```

## Preparing your Content

TinaCloud will be used to locate and filter your content. We'll need add a couple of fields to your existing collections to enable the content checks.

```tsx
const MyCollection : Collection = {
  label: 'My Collection'
  name: 'myCollection'
  format: 'mdx'
  fields: [
    // new field
    {
      type: 'datetime',
      name: 'lastChecked',
      ui: {
        component: 'hidden',
      }
    },
    //...
  ]

}

```

> Be sure to regenerate and commit your  `tina-lock.json` after adding the new field .

In order for the script to run we need to seed all of you existing content with a `lastChecked` field.

Navigate to the directory for the workflow and add an env file

```bash
cd ./github/scripts/tina-helpers
touch .env
```

Add your Tina Token and Tina Client ID the .env file. These are the same properties you'll be adding to your [GitHub secrets](/docs/guides/content-auditing-github-actions#secrets).

You'll also need to add **TINA\_CONTENT\_QUERY**. See [setting your environment variables](/docs/guides/content-auditing-github-actions#adding-your-query).

Once you've supplied these values.

```bash
pnpm run migrate-content
```

## Running the Query

Once you've finished setting up the GitHub action for your own project

![Pull Request with Last Checked date updated in GitHub](/img/docs/content-audit-github-actions/content-audit-pr.png "Pull Request with Last Checked date updated")

![Running a content audit in GitHub Actions](/img/docs/content-audit-github-actions/running-github-action.gif "Running a Content Audit in GitHub")
