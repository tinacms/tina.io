---
draft: false
seo:
  title: ä½¿ç”¨ TinaCMS ä¸ Next.js | TinaCMS åšå®¢
  description: >-
    å­¦ä¹ å¦‚ä½•å°† TinaCMS ä¸ Next.js é›†æˆï¼Œæä¾›å¼ºå¤§è€Œçµæ´»çš„å†…å®¹ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œå®ç°å¿«é€Ÿå’ŒåŠ¨æ€çš„ç½‘é¡µå¼€å‘ã€‚
title: ä½¿ç”¨ TinaCMS ä¸ Next.js
date: '2019-12-02T07:00:00.000Z'
last_edited: '2022-02-18T07:00:00.000Z'
author: Kendall Strautman & James Perkins
prev: content/blog-zh/introducing-tina-grande.mdx
next: content/blog-zh/deprecating-tina-git-server.mdx
---

## Tina + Next: ç¬¬äºŒéƒ¨åˆ†

è¿™ç¯‡åšå®¢æ˜¯æ¢ç´¢ä½¿ç”¨ Next.js + Tina ç³»åˆ—çš„ä¸€éƒ¨åˆ†ã€‚åœ¨[ç¬¬ä¸€éƒ¨åˆ†](https://tinacms.org/blog/simple-markdown-blog-nextjs/)ä¸­ï¼Œæ‚¨å­¦ä¹ äº†å¦‚ä½•ä½¿ç”¨ Next åˆ›å»ºä¸€ä¸ªç®€å•çš„åŸºäº Markdown çš„åšå®¢ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæ‚¨å°†é€šè¿‡é…ç½® TinaCMS ä¸ºç½‘ç«™æ·»åŠ å†…å®¹ç¼–è¾‘åŠŸèƒ½ã€‚

### Next.js å›é¡¾ â–²

[Next.js](https://nextjs.org/) æ˜¯ä¸€ä¸ªç”± [Vercel](https://vercel.com/) å›¢é˜Ÿæ„å»ºçš„ç”¨äºå¼€å‘ Web åº”ç”¨ç¨‹åºçš„ **React â€œå…ƒæ¡†æ¶â€**ï¼ˆä¸€ä¸ªåŸºäºæ¡†æ¶æ„å»ºçš„æ¡†æ¶ï¼‰ã€‚é˜…è¯»[ç¬¬ä¸€éƒ¨åˆ†](/blog/simple-markdown-blog-nextjs/)ä»¥ç†Ÿæ‚‰ Next.js çš„åŸºç¡€çŸ¥è¯†ã€‚

### Tina æ¦‚è¿° ğŸ¦™

[Tina](https://tina.io/) æ˜¯ä¸€ä¸ªåŸºäº Git çš„æ— å¤´å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œä½¿å¼€å‘äººå‘˜å’Œå†…å®¹åˆ›ä½œè€…èƒ½å¤Ÿæ— ç¼åä½œã€‚ä½¿ç”¨ Tinaï¼Œå¼€å‘äººå‘˜å¯ä»¥åˆ›å»ºä¸€ä¸ªå®Œå…¨é€‚åˆå…¶ç½‘ç«™çš„è‡ªå®šä¹‰å¯è§†åŒ–ç¼–è¾‘ä½“éªŒã€‚

ä½“éªŒ Tina çš„æœ€ä½³æ–¹å¼æ˜¯ä½¿ç”¨å®ƒã€‚æˆ‘ä»¬å¸Œæœ›é€šè¿‡æœ¬æ•™ç¨‹ï¼Œæ‚¨ä¸ä»…èƒ½å­¦ä¼šå¦‚ä½•ä½¿ç”¨ Tinaï¼Œè¿˜èƒ½äº†è§£ Tina å¦‚ä½•é‡æ–°æ€è€ƒ CMS çš„å·¥ä½œæ–¹å¼ã€‚

## è®©æˆ‘ä»¬å¼€å§‹å§

![tinacms ç¼–è¾‘ gif](/gif/tina-nextjs.gif)

æœ¬æ•™ç¨‹å°†å‘æ‚¨å±•ç¤ºå¦‚ä½•å®‰è£…å’Œ**é…ç½® Tina ä»¥ç¼–è¾‘ä¸Šå‘¨æ–‡ç« ä¸­åˆ›å»ºçš„ç®€å•åŸºäº Markdown çš„åšå®¢**ã€‚å¦‚æœæ‚¨æƒ³æ·±å…¥äº†è§£åŸºç¡€åšå®¢çš„åˆ¶ä½œè¿‡ç¨‹ï¼Œè¯·é˜…è¯»æœ¬ç³»åˆ—çš„[ç¬¬ä¸€éƒ¨åˆ†](/blog/simple-markdown-blog-nextjs/)ã€‚

> è·³åˆ°è¿™é‡ŒæŸ¥çœ‹ [Tina æ–‡æ¡£](/docs/setup-overview/)

### æœ¬åœ°è®¾ç½® ğŸ¡

è¯·éšæ„æŒ‰ç…§è¿™äº›æŒ‡å—å°†å…¶é€‚é…åˆ°æ‚¨è‡ªå·±çš„ç½‘ç«™æˆ–åšå®¢ï¼Œæˆ–è€…æ‚¨å¯ä»¥ä½¿ç”¨æˆ‘ä»¬åœ¨ä¸Šä¸€ä¸ªæ•™ç¨‹ä¸­åˆ›å»ºçš„å…¥é—¨æ¨¡æ¿ã€‚åœ¨ç»ˆç«¯ä¸­ï¼Œå¯¼èˆªåˆ°æ‚¨å¸Œæœ›åšå®¢æ‰€åœ¨çš„ä½ç½®ï¼Œç„¶åè¿è¡Œï¼š

```bash
# å…‹éš†ä»“åº“
$ git clone https://github.com/tinalabs/brevifolia-next-2022 next-tina-blog

# å¯¼èˆªåˆ°ç›®å½•
$ cd next-tina-blog

# å®‰è£…ä¾èµ– & åˆå§‹åŒ– Tina
$ yarn install
$ npx @tinacms/cli@latest init

$ æ‚¨å¸Œæœ›æˆ‘ä»¬è¦†ç›–æ‚¨çš„ _app.js å—ï¼Ÿæ˜¯
```

`npx @tinacms/cli@latest init` å‘½ä»¤åœ¨æ‚¨çš„ Next.js åº”ç”¨ç¨‹åºä¸­æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š

* å®‰è£… Tina æ‰€éœ€çš„æ‰€æœ‰ä¾èµ–
* åœ¨ .tina ç›®å½•ä¸­å®šä¹‰ä¸€ä¸ªæ˜“äºæ‰©å±•çš„åŸºæœ¬æ¶æ„
* ä½¿ç”¨ Tina åŒ…è£…æ‚¨çš„ next.js åº”ç”¨ç¨‹åºï¼Œä»¥ä¾¿ä»»ä½•é¡µé¢éƒ½å¯ä»¥è½»æ¾ç¼–è¾‘
* åœ¨ demo ç›®å½•ä¸­åˆ›å»ºç¤ºä¾‹å†…å®¹
* ç¼–è¾‘ package.json ä»¥æ·»åŠ å¯åŠ¨ tina çš„è„šæœ¬ï¼ˆdevã€buildã€startï¼‰

### å¿«é€Ÿæµ‹è¯•

ç°åœ¨æ‚¨æœ‰äº†ä¸€ä¸ªåŸºæœ¬çš„ Tina è®¾ç½®ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤å¯åŠ¨æ‚¨çš„åº”ç”¨ç¨‹åºï¼š

```bash
yarn dev
```

å¯åŠ¨åº”ç”¨ç¨‹åºåï¼Œæ‚¨å°†æœ‰å‡ ä¸ªæ–°çš„ URLï¼š

* `http://localhost:3000/demo/blog/HelloWorld`
* `http://localhost:4001/altair/`

ç¬¬ä¸€ä¸ª URL å°†å¸¦æ‚¨åˆ° TinaCMS çš„æ¼”ç¤ºï¼Œå®ƒå°†å‘æ‚¨å±•ç¤º Tina çš„å¼ºå¤§åŠŸèƒ½ï¼Œå¹¶æä¾›ä¸€äº›ä¿¡æ¯é“¾æ¥ä¾›æ‚¨æŸ¥çœ‹ã€‚å¦‚æœæ‚¨å¯¼èˆªåˆ° [http://localhost:3000/demo/blog/HelloWorld](http://localhost:3000/demo/blog/HelloWorld)ï¼Œæ‚¨å°†æ— æ³•ç«‹å³ç¼–è¾‘ã€‚é¦–å…ˆï¼Œæ‚¨éœ€è¦è¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚è¦è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œè¯·å¯¼èˆªåˆ° [http://localhost:3000/admin](http://localhost:3000/admin)ï¼Œé€‰æ‹©ç™»å½•ã€‚ç„¶åè¿”å›åˆ° [http://localhost:3000/demo/blog/HelloWorld](http://localhost:3000/demo/blog/HelloWorld)ã€‚é€‰æ‹©å·¦ä¸Šè§’çš„é“…ç¬”å¯ä»¥ç›´æ¥åœ¨å‰ç«¯ç¼–è¾‘é¡µé¢çš„æ ‡é¢˜å’Œæ­£æ–‡ã€‚å½“æ‚¨ç‚¹å‡»ä¿å­˜æ—¶ï¼Œæ‚¨çš„æ›´æ”¹å°†ä¿å­˜åˆ° Markdown æ–‡ä»¶ä¸­ã€‚

> æƒ³æŸ¥çœ‹æ‚¨çš„æ›´æ”¹å—ï¼Ÿæ‰“å¼€ä½äº `/content/posts/HelloWorld.md` çš„æ–‡ä»¶ï¼Œæ‚¨æ‰€åšçš„æ›´æ”¹å°†ä¼šåœ¨é‚£é‡Œï¼è¿™é€šè¿‡æˆ‘ä»¬çš„å†…å®¹ API å®ç°ï¼Œæˆ‘ä»¬å°†åœ¨æœ¬æŒ‡å—ä¸­æ›´æ·±å…¥åœ°æ¢è®¨ã€‚

ç¬¬äºŒä¸ª URL [http://localhost:4001/altair/](http://localhost:4001/altair/) å°†å¯åŠ¨ä¸€ä¸ª graphQL å®¢æˆ·ç«¯ï¼Œå…è®¸æ‚¨åœ¨æœ¬æŒ‡å—ä¸­è¿›è¡Œäº¤äº’å’Œåˆ›å»ºæŸ¥è¯¢ã€‚

## å®šä¹‰æˆ‘ä»¬çš„å†…å®¹ç»“æ„

Tina çš„ä¸€ä¸ªå…³é”®å…ƒç´ æ˜¯å®šä¹‰ä¸€ä¸ªæ¶æ„ï¼Œå…è®¸æ‚¨å¡‘é€ å’Œä¸é¡µé¢ä¸Šçš„å†…å®¹è¿›è¡Œäº¤äº’ã€‚æ‰“å¼€é¡¹ç›®ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªåä¸º `.tina` çš„æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­åŒ…å«ä¸€ä¸ª `schema.ts` æ–‡ä»¶ã€‚æ­¤æ–‡ä»¶å…è®¸æ‚¨æŒ‡ç¤º Tina çš„å†…å®¹ API æŸ¥æ‰¾å“ªç§å†…å®¹ç±»å‹ã€å¦‚ä½•æ ‡è®°ç­‰ï¼

åœ¨æŸ¥çœ‹å½“å‰é¡¹ç›®ä¹‹å‰ï¼Œè®©æˆ‘ä»¬è®¨è®ºä¸€ä¸‹å†…å®¹çš„ç»“æ„ã€‚æˆ‘ä»¬çš„æ¶æ„å¯ä»¥åˆ†ä¸ºä¸‰ä¸ªæ¦‚å¿µï¼š`collections`ã€`fields` å’Œ `references`ã€‚æ¯ä¸ªéƒ½æœ‰å…¶è§’è‰²ï¼š

### Collections

æ¶æ„ä¸­çš„é¡¶çº§é”®æ˜¯ä¸€ä¸ª *collections* æ•°ç»„ï¼Œä¸€ä¸ª `collection` å‘ŠçŸ¥ API *åœ¨å“ªé‡Œ* ä¿å­˜å†…å®¹ã€‚åœ¨æˆ‘ä»¬çš„æŒ‡å—ä¸­ï¼Œæˆ‘ä»¬å°†æœ‰ä¸€ä¸ª `posts` é›†åˆï¼Œä½†æ‚¨ä¹Ÿå¯ä»¥æœ‰ä¸€ä¸ª `author` å’Œ `pages` é›†åˆï¼Œä¾‹å¦‚ã€‚

### Fields

å­—æ®µæŒ‡ç¤ºå†…å®¹ API é¢„æœŸçš„ç±»å‹ï¼Œä¾‹å¦‚ `text`ï¼Œä»¥åŠå¯æŸ¥è¯¢çš„åç§°å’Œè¦æ˜¾ç¤ºç»™æ‚¨çš„å†…å®¹å›¢é˜Ÿçš„åç§°ã€‚å­—æ®µæ˜¯é›†åˆçš„å­å¯¹è±¡æ•°ç»„ã€‚æˆ‘ä»¬ä½¿ç”¨å®ƒæ¥ä» Markdown æˆ– JSON æ–‡ä»¶ä¸­æ£€ç´¢å†…å®¹ï¼Œè¿™äº›å­—æ®µåº”æ˜ å°„åˆ°æ‚¨çš„ *frontmatter*ï¼Œæˆ‘ä»¬è¿˜ä½¿ç”¨å®ƒæ¥åˆ›å»ºç”¨äºç¼–è¾‘çš„ UI å…ƒç´ ã€‚

```json
fields: [
    {
      type: "string",
      label: "Title",
      name: "title"
    },
    {
      type: "string",
      label: "Blog Post Body",
      name: "body",
      isBody: true,
    },
]
```

### References

è¿™æ˜¯ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œå½“æ‚¨ *å¼•ç”¨* å¦ä¸€ä¸ªé›†åˆæ—¶ï¼Œæ‚¨å®é™…ä¸Šæ˜¯åœ¨è¯´ï¼šâ€œè¿™ä¸ªæ–‡æ¡£ *å±äº* é‚£ä¸ªæ–‡æ¡£â€ã€‚ä½¿ç”¨å¼•ç”¨çš„ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­æ˜¯ *author*ï¼Œå› ä¸ºæ¯ä¸ªå¸–å­éƒ½æœ‰ä¸€ä¸ªä½œè€…ï¼Œæ‚¨å¯ä»¥æœ‰å¤šä¸ªä½œè€…ï¼Œä½†æ‚¨éœ€è¦å°†ç‰¹å®šçš„ä½œè€…å¼•ç”¨åˆ°å¸–å­ã€‚

```json
{
  "label": "Author",
  "name": "author",
  "type": "reference",
  "collections": ["author"] // æŒ‡å‘åä¸º "author" çš„é›†åˆ
}
```

> åœ¨æˆ‘ä»¬ç»§ç»­ä¹‹å‰ï¼Œæ‚¨å¯ä»¥åœ¨æˆ‘ä»¬çš„[æ–‡æ¡£](/docs/schema/)ä¸­é˜…è¯»æ›´å¤šå…³äºå†…å®¹å»ºæ¨¡çš„ä¿¡æ¯

## åˆ›å»ºæ‚¨çš„å†…å®¹æ¶æ„

ä»å¦ä¸€ç¯‡åšå®¢æ–‡ç« æä¾›çš„åšå®¢ä¸­åŒ…å«å››ä¸ªç¤ºä¾‹åšå®¢å¸–å­ï¼Œæ‚¨å°†ä½¿ç”¨è¿™äº›å¸–å­åœ¨æ¶æ„ä¸­å¡‘é€ æ‚¨çš„å†…å®¹ã€‚æ‚¨å¯ä»¥åœ¨ `posts` ç›®å½•ä¸­çš„ä»»ä½•åšå®¢å¸–å­ä¸­æ‰¾åˆ°ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹ `bali.md` çš„ front matterã€‚

```md
---
author: Siddhartha Mukherjee
date: '2019-07-10T07:00:00.000Z'
hero_image: /alfons-taekema-bali.jpg
title: 'Bali â€”body, mind & soul'
---

æœ¯è¯­ **bristlecone pine** æ¶µç›–äº†ä¸‰ç§ ...
```

å¦‚æ‚¨æ‰€è§ï¼Œæ‚¨æœ‰ä¸€äº›å­—æ®µå¸Œæœ›èƒ½å¤Ÿç¼–è¾‘ï¼Œä»¥åŠåšå®¢å¸–å­çš„æ­£æ–‡ã€‚

### å¯¹æ¶æ„è¿›è¡Œæ›´æ”¹

æ‰“å¼€ä½äº `/.tina/schema.ts` çš„ Tina `schema.ts` æ–‡ä»¶ã€‚é¦–å…ˆåœ¨æˆ‘ä»¬æä¾›çš„å¯¹è±¡ä¸‹æ–¹ï¼Œæ‚¨éœ€è¦ç”¨æ‚¨æƒ³è¦çš„å†…å®¹æ›¿æ¢å½“å‰é›†åˆï¼š

```diff
{
  label: "Blog Posts",
  name: "post",
-  path: "content/posts"
+  path: 'posts',
  fields: [
    {
      type: "string",
      label: "Title",
      name: "title"
    },
    {
      type: "string",
      label: "Blog Post Body",
      name: "body",
      isBody: true,
    },
  ]
}
```

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæ‚¨åªæ›¿æ¢äº†ä¸€è¡Œï¼Œå³å°† `path` æ›´æ–°ä¸ºåšå®¢å†…å®¹çš„æ­£ç¡®ä½ç½®ã€‚

ç°åœ¨æ‚¨éœ€è¦å¤„ç†æ¯ä¸ªå¸–å­ frontmatter çš„å­—æ®µï¼Œä¸‹é¢æ˜¯å®Œæˆçš„æ–‡ä»¶ï¼š

```js
import { defineSchema } from 'tinacms';

export default defineSchema({
  collections: [
    {
      label: 'Blog Posts',
      name: 'post',
      path: '_posts',
      fields: [
        {
          type: 'string',
          label: 'Title',
          name: 'title',
        },
        {
          type: 'string',
          label: 'Author',
          name: 'author',
        },
        {
          type: 'datetime',
          label: 'Date',
          name: 'date',
        },
        {
          type: 'string',
          label: 'Image',
          name: 'hero_image',
        },
        {
          type: 'string',
          label: 'Body',
          name: 'body',
          isBody: true,
        },
      ],
    },
  ],
});
```

æ‚¨å¯èƒ½ä¼šæ³¨æ„åˆ°ä¸€äº›äº‹æƒ…ã€‚é¦–å…ˆï¼Œæ‚¨æœ‰ä¸€ä¸ªåä¸º `datetime` çš„ `type`ï¼Œå®ƒé€šè¿‡æä¾›ä¸€ä¸ªæ—¥æœŸé€‰æ‹©å™¨ä¾›æ‚¨ä½¿ç”¨ï¼Œå¹¶å°†æ ¼å¼åŒ–æ—¥æœŸå’Œæ—¶é—´ã€‚

å…¶æ¬¡ï¼Œæœ‰ä¸€ä¸ªåä¸º `body` çš„ `string` å­—æ®µï¼Œ`isBody` è®¾ç½®ä¸º trueã€‚é€šè¿‡å°† `isBody` è®¾ç½®ä¸º trueï¼Œæ‚¨å£°æ˜æ­¤å­—æ®µè´Ÿè´£ Markdown æ–‡ä»¶çš„ä¸»è¦ *body*ã€‚åªèƒ½æœ‰ä¸€ä¸ªå­—æ®µå…·æœ‰ `isBody: true` å±æ€§ã€‚

### ä¸‹ä¸€æ­¥

æ‚¨çš„ Markdown æ–‡ä»¶ç°åœ¨ç”±ä¸€ä¸ªå®šä¹‰è‰¯å¥½çš„æ¶æ„æ”¯æŒï¼Œè¿™ä¸ºæˆ‘ä»¬ä½¿ç”¨ GraphQL æŸ¥è¯¢æ–‡ä»¶å†…å®¹é“ºå¹³äº†é“è·¯ã€‚æ‚¨ä¼šæ³¨æ„åˆ°ï¼Œå½“åœ¨ Next.js åšå®¢å…¥é—¨æ¨¡æ¿ä¸­å¯¼èˆªæ—¶ï¼Œä»€ä¹ˆéƒ½æ²¡æœ‰æ”¹å˜ï¼Œè¿™æ˜¯å› ä¸ºæ‚¨éœ€è¦æ›´æ–°å…¥é—¨æ¨¡æ¿ä»¥ä½¿ç”¨æ‚¨çš„ GraphQL å±‚ï¼Œè€Œä¸æ˜¯ç›´æ¥è®¿é—® Markdown æ–‡ä»¶ã€‚åœ¨ä¸‹ä¸€èŠ‚ä¸­ï¼Œæ‚¨å°†å¤„ç†å°†å‰ç«¯è½¬æ¢ä¸ºä½¿ç”¨ TinaCMSã€‚

ç›®å‰ï¼ŒNext åšå®¢å…¥é—¨æ¨¡æ¿ä»æ–‡ä»¶ç³»ç»Ÿä¸­è·å–å†…å®¹ã€‚ä½†ç”±äº Tina å¸¦æœ‰ä¸€ä¸ªæ–‡ä»¶ç³»ç»Ÿä¹‹ä¸Šçš„ GraphQL APIï¼Œæ‚¨å°†æ”¹ä¸ºæŸ¥è¯¢å®ƒã€‚ä½¿ç”¨ GraphQL API å°†å…è®¸æ‚¨ä½¿ç”¨ TinaCMS çš„å¼ºå¤§åŠŸèƒ½ï¼Œæ‚¨å°†èƒ½å¤Ÿæ£€ç´¢å†…å®¹ï¼Œè¿˜å¯ä»¥ç›´æ¥ç¼–è¾‘å’Œä¿å­˜å†…å®¹ã€‚

## åˆ›å»º getStaticPaths æŸ¥è¯¢

`getStaticPaths` æŸ¥è¯¢éœ€è¦çŸ¥é“æ‰€æœ‰ Markdown æ–‡ä»¶çš„ä½ç½®ï¼Œä½¿ç”¨æ‚¨å½“å‰çš„æ¶æ„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ `postConnection`ï¼Œå®ƒå°†æä¾› `posts` æ–‡ä»¶å¤¹ä¸­æ‰€æœ‰å¸–å­çš„åˆ—è¡¨ã€‚ç¡®ä¿æ‚¨çš„æœ¬åœ°æœåŠ¡å™¨æ­£åœ¨è¿è¡Œï¼Œå¹¶å¯¼èˆªåˆ° [http://localhost:4001/altair](http://localhost:4001/altair) å¹¶é€‰æ‹© Docs æŒ‰é’®ã€‚Docs æŒ‰é’®ä½¿æ‚¨èƒ½å¤ŸæŸ¥çœ‹æ‰€æœ‰å¯èƒ½çš„æŸ¥è¯¢å’Œè¿”å›çš„å˜é‡ï¼š

<WebmEmbed embedSrc="/img/docs/altair_doc.webm" />

å› æ­¤ï¼ŒåŸºäº `postConnection`ï¼Œæ‚¨å°†å¸Œæœ›æŸ¥è¯¢ `sys`ï¼Œå³æ–‡ä»¶ç³»ç»Ÿï¼Œå¹¶æ£€ç´¢ `filename`ï¼Œè¿™å°†è¿”å›æ‰€æœ‰ä¸å¸¦æ‰©å±•åçš„æ–‡ä»¶åã€‚

```graphql
query {
  postConnection {
    edges {
      node {
        _sys {
          filename
        }
      }
    }
  }
}
```

å¦‚æœæ‚¨åœ¨ GraphQL å®¢æˆ·ç«¯ä¸­è¿è¡Œæ­¤æŸ¥è¯¢ï¼Œæ‚¨å°†çœ‹åˆ°ä»¥ä¸‹è¿”å›ï¼š

```json
{
  "data": {
    "postConnection": {
      "edges": [
        {
          "node": {
            "_sys": {
              "filename": "bali"
            }
          }
        },
        {
          "node": {
            "_sys": { "filename": "iceland" }
          }
        },
        {
          "node": {
            "_sys": { "filename": "joshua-tree" }
          }
        },
        {
          "node": {
            "_sys": { "filename": "mauritius" }
          }
        }
      ]
    }
  }
}
```

### å°†æ­¤æŸ¥è¯¢æ·»åŠ åˆ°æ‚¨çš„åšå®¢

ä¸Šé¢çš„æŸ¥è¯¢å¯ä»¥ç”¨æ¥åˆ›å»ºæ‚¨çš„åŠ¨æ€è·¯å¾„ï¼Œè¿™å‘ç”Ÿåœ¨ `[slug].js` æ–‡ä»¶ä¸­ã€‚å½“æ‚¨æ‰“å¼€æ–‡ä»¶æ—¶ï¼Œæ‚¨å°†çœ‹åˆ°ä¸€ä¸ªåä¸º getStaticPaths çš„å‡½æ•°ä½äºæ–‡ä»¶åº•éƒ¨ã€‚

```javascript
export async function getStaticPaths() {

....
```

åˆ é™¤æ­¤å‡½æ•°ä¸­çš„æ‰€æœ‰ä»£ç ï¼Œæ‚¨å¯ä»¥æ›´æ–°å®ƒä»¥ä½¿ç”¨æ‚¨è‡ªå·±çš„ä»£ç ã€‚ç¬¬ä¸€æ­¥æ˜¯åœ¨æ–‡ä»¶é¡¶éƒ¨æ·»åŠ ä¸€ä¸ªå¯¼å…¥ï¼Œä»¥ä¾¿èƒ½å¤Ÿä¸æ‚¨çš„ graphql å±‚è¿›è¡Œäº¤äº’ã€‚åœ¨é‚£é‡Œï¼Œæ‚¨å¯ä»¥åˆ é™¤ `glob`ï¼Œå› ä¸ºæ‚¨å°†ä¸å†éœ€è¦å®ƒã€‚

```diff
//å…¶ä»–å¯¼å…¥
.....
+ import { staticRequest } from "tinacms";
- const glob = require('glob')
```

> â€œstaticRequest æ˜¯åšä»€ä¹ˆçš„ï¼Ÿâ€

> å®ƒåªæ˜¯ä¸€ä¸ªå¸®åŠ©å‡½æ•°ï¼Œå‘æ‚¨æœ¬åœ°è¿è¡Œçš„ GraphQL æœåŠ¡å™¨æä¾›æŸ¥è¯¢ï¼Œè¯¥æœåŠ¡å™¨åœ¨ç«¯å£ 4001 ä¸Šå¯åŠ¨ã€‚æ‚¨ä¹Ÿå¯ä»¥è½»æ¾åœ°ä½¿ç”¨ fetch æˆ–æ‚¨é€‰æ‹©çš„ http å®¢æˆ·ç«¯ã€‚

åœ¨ `getStaticPaths` å‡½æ•°å†…éƒ¨ï¼Œæ‚¨å¯ä»¥æ„å»ºå¯¹æˆ‘ä»¬çš„å†…å®¹ API çš„è¯·æ±‚ã€‚åœ¨å‘å‡ºè¯·æ±‚æ—¶ï¼ŒTina æœŸæœ›ä¼ é€’æŸ¥è¯¢æˆ–å˜æ›´ä»¥åŠå˜é‡ï¼Œè¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š

```javascript
staticRequest({
  query: '...', // æˆ‘ä»¬çš„æŸ¥è¯¢
  variables: {...}, // æŸ¥è¯¢ä½¿ç”¨çš„ä»»ä½•å˜é‡
}),
```

æ‚¨å¯ä»¥ä½¿ç”¨ä¹‹å‰çš„ `postConnection` æŸ¥è¯¢æ¥æ„å»ºæ‚¨çš„åŠ¨æ€è·¯ç”±ï¼š

```js
export async function getStaticPaths() {
  const postsListData = await staticRequest({
    query: `
      query {
        postConnection {
          edges {
            node {
              _sys {
                filename
              }
            }
          }
        }
      }
    `,
    variables: {},
  });
  return {
    paths: postsListData.postConnection.edges.map((edge) => ({
      params: { slug: edge.node._sys.filename },
    })),
    fallback: false,
  };
}
```

#### `getStaticPaths` çš„å¿«é€Ÿåˆ†è§£

`getStaticPaths` ä»£ç è·å–æ‚¨åˆ›å»ºçš„ graphql æŸ¥è¯¢ï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä»»ä½• `variables`ï¼Œæ‚¨å¯ä»¥å‘é€ä¸€ä¸ªç©ºå¯¹è±¡ã€‚åœ¨è¿”å›åŠŸèƒ½ä¸­ï¼Œæ‚¨éå† `postsListData.getPostList` ä¸­çš„æ¯ä¸ªé¡¹ç›®ï¼Œå¹¶ä¸ºæ¯ä¸ªé¡¹ç›®åˆ›å»ºä¸€ä¸ª slugã€‚

æ‚¨ç°åœ¨éœ€è¦åˆ›å»ºå¦ä¸€ä¸ªæŸ¥è¯¢ï¼Œæ­¤æŸ¥è¯¢å°†å¡«å……æ‰€æœ‰æ•°æ®ï¼Œå¹¶ä½¿æ‚¨èƒ½å¤Ÿä½¿æ‰€æœ‰åšå®¢å¸–å­å¯ç¼–è¾‘ã€‚

ç»§ç»­æµ‹è¯•æ‚¨çš„åšå®¢å¸–å­æ˜¯å¦ä»ç„¶å¯è¯»ï¼Œä¾‹å¦‚å¯¼èˆªåˆ° [http://localhost:3000/blog/bali](http://localhost:3000/blog/bali)

## åˆ›å»º `getStaticProps` æŸ¥è¯¢

`getStaticProps` æŸ¥è¯¢å°†å‘åšå®¢æä¾›æ‰€æœ‰å†…å®¹ï¼Œè¿™å°±æ˜¯å®ƒå½“å‰çš„å·¥ä½œæ–¹å¼ã€‚å½“æ‚¨ä½¿ç”¨ GraphQL API æ—¶ï¼ŒTina å°†åŒæ—¶æä¾›å†…å®¹ï¼Œå¹¶ä½¿å†…å®¹å›¢é˜Ÿèƒ½å¤Ÿç›´æ¥åœ¨æµè§ˆå™¨ä¸­ç¼–è¾‘å®ƒã€‚

æ‚¨éœ€è¦ä»æ‚¨çš„å†…å®¹ API ä¸­æŸ¥è¯¢ä»¥ä¸‹é¡¹ç›®ï¼š

* author
* date
* hero\_image
* title

### åˆ›å»ºæ‚¨çš„æŸ¥è¯¢

ä½¿ç”¨æ‚¨çš„æœ¬åœ° graphql å®¢æˆ·ç«¯ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨åšå®¢å¸–å­çš„è·¯å¾„æŸ¥è¯¢ `post`ï¼Œä¸‹é¢æ˜¯æ‚¨éœ€è¦å¡«å†™çš„éª¨æ¶ã€‚

```graphql
query BlogPostQuery($relativePath: String!) {
  post(relativePath: $relativePath) {
    # è¿™æ˜¯æ‚¨å¸Œæœ›ä»å¸–å­ä¸­æ£€ç´¢çš„æ•°æ®ã€‚
  }
}
```

> å¦‚æœæ‚¨ä»¥å‰æ²¡æœ‰ä½¿ç”¨è¿‡ graphqlï¼Œæ‚¨ä¼šæ³¨æ„åˆ°ä¸€ä¸ªå¥‡æ€ªçš„ `$relativePath` åè·Ÿ `String!`ã€‚è¿™æ˜¯ä¸€ä¸ªå˜é‡ï¼ŒString! è¡¨ç¤ºå®ƒå¿…é¡»æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¹¶ä¸”æ˜¯å¿…éœ€çš„ã€‚

æ‚¨ç°åœ¨å¯ä»¥å¡«å†™æ‚¨éœ€è¦æŸ¥è¯¢çš„ç›¸å…³å­—æ®µã€‚åœ¨æ•°æ®å¯¹è±¡ä¸­æ·»åŠ å­—æ®µ authorã€dateã€hero\_imageã€titleã€‚æ‚¨è¿˜å¸Œæœ›æ£€ç´¢åšå®¢å¸–å­çš„æ­£æ–‡ï¼Œä»¥ä¾¿å¯ä»¥æ·»åŠ æ–°å†…å®¹ã€‚æ‚¨åº”è¯¥æœ‰ä¸€ä¸ªå¦‚ä¸‹æ‰€ç¤ºçš„æŸ¥è¯¢ï¼š

```graphql
query BlogPostQuery($relativePath: String!) {
  getPostDocument(relativePath: $relativePath) {
    title
    date
    hero_image
    author
    body
  }
}
```

> å¦‚æœæ‚¨æƒ³æµ‹è¯•ä¸€ä¸‹ï¼Œå¯ä»¥åœ¨åº•éƒ¨çš„å˜é‡éƒ¨åˆ†æ·»åŠ ä»¥ä¸‹å†…å®¹ `{"relativePath": "bali.md"}`

### ä½¿ç”¨ä¸Šä¸‹æ–‡ç¼–è¾‘

æ‚¨éœ€è¦åœ¨åšå®¢ä¸Šè®¾ç½®ä¸Šä¸‹æ–‡ç¼–è¾‘ï¼Œä»¥ä¾¿å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ä¾§è¾¹æ ç¼–è¾‘å†…å®¹ï¼Œç±»ä¼¼äºå¼€å¤´çš„æ¼”ç¤ºã€‚é¦–å…ˆï¼Œæ‚¨éœ€è¦åœ¨é¡µé¢é¡¶éƒ¨å¯¼å…¥ `useTina` é’©å­ã€‚

```javascript
//... æ‰€æœ‰å¯¼å…¥
import { useTina } from 'tinacms/dist/edit-state';
```

> ä»€ä¹ˆæ˜¯ `useTina`ï¼Ÿ

> `useTina` æ˜¯ä¸€ä¸ªé’©å­ï¼Œå¯ç”¨äºä½¿ Tina å†…å®¹çš„ä¸€éƒ¨åˆ†åœ¨ä¸Šä¸‹æ–‡ä¸­å¯ç¼–è¾‘ã€‚å®ƒæ˜¯ä»£ç åˆ†å‰²çš„ï¼Œå› æ­¤åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œæ­¤é’©å­å°†ç®€å•åœ°ä¼ é€’å…¶æ•°æ®å€¼ã€‚åœ¨ç¼–è¾‘æ¨¡å¼ä¸­ï¼Œå®ƒåœ¨ä¾§è¾¹æ ä¸­æ³¨å†Œä¸€ä¸ªå¯ç¼–è¾‘çš„è¡¨å•ï¼Œå¹¶åœ¨ç”¨æˆ·è¾“å…¥æ—¶ä¸Šä¸‹æ–‡æ›´æ–°å…¶å€¼ã€‚

æ‚¨ç°åœ¨å¯ä»¥å°†æ‚¨åˆ›å»ºçš„æŸ¥è¯¢ç”¨ä½œå˜é‡ï¼Œæ­¤å˜é‡å°†åœ¨æ‚¨çš„ `getStaticProps` å’Œ `useTina` é’©å­ä¸­ä½¿ç”¨ã€‚

```javascript
const query = `query BlogPostQuery($relativePath: String!) {
  post(relativePath: $relativePath) {
    title
    date
    hero_image
    author
    body
  }
}`;
```

#### æ›¿æ¢æ‚¨çš„ getStaticProps

è¦æ›¿æ¢æ‚¨çš„ getStaticPropsï¼Œæ‚¨å°†ä»¥ç±»ä¼¼äºåœ¨ `getStaticPaths` ä»£ç ä¸­ä½¿ç”¨çš„æ–¹å¼ä½¿ç”¨ `staticRequest`ã€‚

é¦–å…ˆè¦åšçš„æ˜¯åˆ é™¤æ‚¨ä¸å†éœ€è¦çš„æ‰€æœ‰ä»£ç ï¼ŒåŒ…æ‹¬ `content` å’Œ `data` å˜é‡ä»¥åŠ `markdownBody`ã€`frontmatter` ä»æ‚¨çš„ props ä¸­ã€‚

```diff
export async function getStaticProps({ ...ctx }) {
  const { slug } = ctx.params
- const content = await import(`../../posts/${slug}.md`)
  const config = await import(`../../data/config.json`)
- const data = matter(content.default)

  return {
    props: {
       siteTitle: config.title,
-      frontmatter: data.data,
-     markdownBody: data.content,
    },
  }
}
```

ç°åœ¨æ‚¨å·²ä»ä»£ç ä¸­åˆ é™¤äº†è¿™äº›å†…å®¹ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æˆ‘ä»¬çš„ `staticRequest` æ¥æ£€ç´¢æ•°æ®ã€‚å”¯ä¸€çš„åŒºåˆ«æ˜¯è¿™æ¬¡æ‚¨å®é™…ä¸Šéœ€è¦ä¸€ä¸ªåä¸º `relativePath` çš„å˜é‡ï¼Œå®ƒæ˜¯ slugã€‚æ‚¨è¿˜éœ€è¦å°†å˜é‡ä½œä¸º prop å‘é€ï¼Œä»¥ä¾¿å¯ä»¥åœ¨æˆ‘ä»¬çš„ `useTina` é’©å­ä¸­ä½¿ç”¨å®ƒã€‚

```javascript
export async function getStaticProps({ ...ctx }) {
  const { slug } = ctx.params
  const config = await import(`../../data/config.json`)
  const data = await staticRequest({
    query,
    variables = {
      relativePath : slug,
    },
  })
  return {
    props: {
      data,
      variables,
      siteTitle: config.title,
    },
  }
}
```

#### æ›´æ–°å®¢æˆ·ç«¯ä»¥ä½¿ç”¨ `useTina`

ç°åœ¨æ‚¨åªä» `getStaticProps` è¿”å›ä¸¤ä¸ª propsï¼Œæ‚¨éœ€è¦æ›´æ–°å®¢æˆ·ç«¯ä»£ç ä»¥ä½¿ç”¨å®ƒä»¬ã€‚åˆ é™¤è§£æ„çš„å…ƒç´ å¹¶å°† `props` ä¼ é€’ç»™æ‚¨çš„å®¢æˆ·ç«¯ã€‚

```javascript
export default function BlogTemplate(props) {
```

ç°åœ¨æ‚¨å¯ä»¥ä½¿ç”¨ `useTina` é’©å­æ¥å¤„ç†å¯è§†åŒ–ç¼–è¾‘ã€‚useTina é’©å­éœ€è¦æŸ¥è¯¢ã€å˜é‡å’Œæ•°æ®ã€‚æ‚¨å¯ä»¥ä»æ‚¨çš„ props ä¸­ä¼ é€’è¿™äº›ã€‚

```
const { data } = useTina({
    query,
    variables: props.variables,
    data: props.data,
  })
```

è¿™æ„å‘³ç€æ‚¨ç°åœ¨å¯ä»¥ä½¿ç”¨ Tina ç¼–è¾‘æ‚¨çš„å†…å®¹ï¼Œä½†åœ¨æ­¤ä¹‹å‰ï¼Œæ‚¨éœ€è¦æ›´æ–°æ‰€æœ‰å…ƒç´ ä»¥ä½¿ç”¨æ‚¨çš„æ–° Tina é©±åŠ¨çš„æ•°æ®ã€‚

```diff
- if (!frontmatter) return <></>
  return (
-    <Layout siteTitle={siteTitle}>
+    <Layout siteTitle={props.siteTitle}>
      <article className={styles.blog}>
        <figure className={styles.blog__hero}>
          <Image
            width="1920"
            height="1080"
-            src={frontmatter.hero_image}
+            src={data.post.hero_image}
-            alt={`blog_hero_${frontmatter.title}`}
+            alt={`blog_hero_${data.post.title}`}
          />
        </figure>
        <div className={styles.blog__info}>
-          <h1>{frontmatter.title}</h1>
+          <h1>{data.post.title}</h1>
-          <h3>{reformatDate(frontmatter.date)}</h3>
+          <h3>{reformatDate(data.post.date)}</h3>
        </div>
        <div className={styles.blog__body}>
-          <ReactMarkdown children={markdownBody} />
+          <ReactMarkdown children={data.post.body} />
        </div>
-        <h2 className={styles.blog__footer}>Written By: {frontmatter.author}</h2>
+        <h2 className={styles.blog__footer}>Written By: {data.post.author}</h2>
      </article>
    </Layout>
  )
}

```

### æµ‹è¯•å’Œç¼–è¾‘å†…å®¹ âœ¨

å¦‚æœä¸€åˆ‡é¡ºåˆ©ï¼Œæ‚¨çš„åšå®¢å¸–å­ç°åœ¨å¯ä»¥é€šè¿‡ Tina ç¼–è¾‘äº†ã€‚è®©æˆ‘ä»¬çœ‹çœ‹å®ƒçš„å®é™…æ•ˆæœï¼

é€šè¿‡è¿è¡Œ `yarn dev` å¯åŠ¨å¼€å‘æœåŠ¡å™¨ï¼Œå¹¶åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ä¸€ä¸ªåšå®¢å¸–å­ã€‚ç»§ç»­è¿›è¡Œç¼–è¾‘ï¼Œç„¶ååœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ£€æŸ¥æºæ–‡ä»¶ã€‚å¦‚æœæ‚¨å°†æµè§ˆå™¨å’Œä»£ç ç¼–è¾‘å™¨å¹¶æ’æ‰“å¼€ï¼Œæ‚¨åº”è¯¥èƒ½å¤Ÿå®æ—¶è§‚å¯Ÿåˆ°æ›´æ”¹åœ¨ä¸¤ä¸ªåœ°æ–¹çš„åæ˜ ï¼

ä¸è¿‡æ‚¨é‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œæ‚¨çš„æ­£æ–‡æ˜¯ä¸€ä¸ªä¸æ”¯æŒ Markdown çš„å°è¾“å…¥æ¡†ï¼æ‚¨åº”è¯¥ä¿®å¤è¿™ä¸ªé—®é¢˜ã€‚

### æ·»åŠ  Markdown æ”¯æŒ

è¦æ·»åŠ  Markdown æ”¯æŒï¼Œæ‚¨éœ€è¦åšä¸¤ä»¶äº‹ã€‚

1. å‘Šè¯‰ Tina å¦‚ä½•ä½¿ç”¨ä¸åŒçš„ç»„ä»¶ã€‚
2. åŠ¨æ€åŠ è½½ Markdown ç»„ä»¶ã€‚

#### æ›´æ–° Tina æ¶æ„

æ‰“å¼€ä½äº `.tina` æ–‡ä»¶å¤¹ä¸­çš„ `schema.ts`ã€‚Tina çš„ä¸€ä¸ªä¼˜ç‚¹æ˜¯æ‚¨å¯ä»¥æ‰©å±• UI å­—æ®µä»¥æ»¡è¶³æ‚¨çš„ç¡®åˆ‡éœ€æ±‚ï¼Œä¸ºæ­¤æ‚¨å¯ä»¥ä½¿ç”¨ `ui` å¯¹è±¡å¹¶å‘Šè¯‰ Tina æ‚¨æƒ³ä½¿ç”¨çš„ç»„ä»¶ã€‚

```typescript
ui: {
  component: COMPONENT_NAME;
}
```

æ‚¨å¸Œæœ›ä½¿ç”¨ Markdown ç»„ä»¶ï¼Œå› æ­¤æ‚¨å¯ä»¥è¦†ç›–æ‚¨çš„æ­£æ–‡ï¼Œå®ƒåº”è¯¥å¦‚ä¸‹æ‰€ç¤ºï¼š

```typescript
{
  type: 'string',
  label: 'Body',
  name: 'body',
  isBody: true,
  ui: {
    component: 'markdown'
  }
},
```

#### æ›´æ–° `_app.js`

åœ¨æ‰“å¼€æ‚¨çš„ `_app.js` æ–‡ä»¶ä¹‹å‰ï¼Œæ‚¨éœ€è¦ä» Tina å®‰è£… Markdown æ’ä»¶ã€‚

```bash,cp
yarn add react-tinacms-editor
```

æ‰“å¼€æ‚¨çš„ `_app.js` æ–‡ä»¶ï¼Œè¿™æ˜¯æ‚¨å°†ä½¿ç”¨ `TinaCMS` ç»„ä»¶çš„ `cmsCallback` prop çš„åœ°æ–¹ï¼Œå®ƒå…è®¸æ‚¨æ‰©å±•é»˜è®¤åŠŸèƒ½ï¼Œæ·»åŠ æ’ä»¶ï¼Œå¤„ç†æ–‡æ¡£åˆ›å»ºç­‰ã€‚

```javascript
cmsCallback={cms => {
```

åœ¨è¿™é‡Œï¼Œæ‚¨ä¼ é€’äº† `cms`ï¼Œç°åœ¨æ‚¨å¯ä»¥å¯¼å…¥æˆ‘ä»¬å®‰è£…çš„ç»„ä»¶ä»¥æ·»åŠ 