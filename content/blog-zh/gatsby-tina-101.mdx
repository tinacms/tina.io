---
draft: false
consumes:
  - file: /packages/gatsby-tinacms-remark/src/remark-creator-plugin.ts
    details: æ¼”ç¤ºRemarkCreatorPluginçš„ä½¿ç”¨
  - file: /packages/gatsby-tinacms-remark/src/remarkFormHoc.tsx
    details: å±•ç¤ºå¦‚ä½•ä½¿ç”¨inlineRemarkForm HOC
  - file: /packages/@tinacms/fields/src/Wysiwyg/Wysiwyg.tsx
    details: TinaFieldä½¿ç”¨Wysiwygç»„ä»¶è¿›è¡Œå†…è”ç¼–è¾‘
warningMessage: >-
  **æ›´æ–°ï¼š** æœ¬æ–‡ä¸­çš„ç¤ºä¾‹å¼•ç”¨äº†è¿‡æ—¶çš„Gatsbyå®ç°ã€‚æˆ‘ä»¬å»ºè®®ä½¿ç”¨[Next.js](/docs/setup-overview/)æ¥è·å¾—æ›´æµç•…çš„è§£å†³æ–¹æ¡ˆã€‚
seo:
  title: Gatsby + Tina 101 | TinaCMSåšå®¢
  description: >-
    åœ¨æœ¬æŒ‡å—ä¸­å­¦ä¹ å°†Gatsbyä¸TinaCMSé›†æˆçš„åŸºç¡€çŸ¥è¯†ï¼Œå¹¶å¼€å§‹ä½¿ç”¨å¼ºå¤§çš„å†…å®¹ç®¡ç†è®¾ç½®æ„å»ºå¿«é€Ÿã€åŠ¨æ€çš„ç½‘ç«™ã€‚
title: Gatsby + Tina 101
date: '2020-02-25T07:00:00.000Z'
author: Madelyn Eriksen
prev: content/blog-zh/custom-field-plugins.mdx
next: content/blog-zh/introducing-visual-open-authoring.mdx
---

åƒ[Gatsby](https://www.gatsbyjs.org/)è¿™æ ·çš„é™æ€ç½‘ç«™ç”Ÿæˆå™¨å¯¹å¼€å‘è€…æ¥è¯´æ˜¯ä¸€ä¸ªå·¨å¤§çš„èƒœåˆ©ã€‚å®ƒä»¬ä¸ºæˆ‘ä»¬æä¾›äº†è‡ªåŠ¨åŒ–éƒ¨ç½²ã€æ›´å¿«çš„å¼€å‘å‘¨æœŸå’Œå‡å°‘çš„å®‰å…¨è´Ÿæ‹…ã€‚

å°½ç®¡åœ¨æŠ€æœ¯ä¸Šå–å¾—äº†è¿›æ­¥ï¼Œ**é™æ€ç½‘ç«™çš„å†…å®¹ç¼–è¾‘æ•…äº‹å¯èƒ½ä¼šå—åˆ°é˜»ç¢ã€‚** é‚£äº›å¯¹Gitå’ŒMarkdownæ„Ÿåˆ°èˆ’é€‚çš„äººå¯èƒ½ä¼šç›´æ¥ç¼–è¾‘æ–‡ä»¶ã€‚ä½†å†…å®¹ä½œè€…éœ€è¦ä¸€ä¸ªæ›´å¥½çš„è§£å†³æ–¹æ¡ˆæ¥è¿›è¡Œç¼–è¾‘ã€‚

[TinaCMS](https://tinacms.org/docs/getting-started/introduction)æ˜¯ä¸€ä¸ª*å¯æ‰©å±•çš„*å·¥å…·åŒ…ï¼Œå¯ä»¥å¸®åŠ©æ»¡è¶³è¿™äº›éœ€æ±‚ã€‚Tinaå…è®¸å¼€å‘è€…ä½¿ç”¨æˆ‘ä»¬å–œçˆ±çš„æ ¼å¼ï¼Œå¦‚Markdownå’ŒJSONï¼ŒåŒæ—¶ä¸ºå†…å®¹ä½œè€…æä¾›æµç•…çš„ä½“éªŒã€‚

ä¸ºäº†æ›´å¥½åœ°ç†è§£Tinaçš„å·¥ä½œåŸç†ï¼Œæˆ‘å†³å®šå°†å…¶æ·»åŠ åˆ°ç°æœ‰ç½‘ç«™ä¸­ï¼Œæˆ‘çš„[Gatsby starter, *Tyra*](https://github.com/madelyneriksen/gatsby-starter-tyra/)ã€‚ä»¥ä¸‹æ˜¯æˆ‘çš„è¿‡ç¨‹æ¼”ç»ƒã€‚è¯·éšæ„*å°†å…¶ç”¨ä½œå°†TinaCMSæ·»åŠ åˆ°ç°æœ‰Gatsbyç½‘ç«™çš„å‚è€ƒï¼*

> **èµ¶æ—¶é—´ï¼Ÿ** åœ¨[GitHub](https://github.com/madelyneriksen/gatsby-starter-tyra/tree/feature/add-tyra)ä¸ŠæŸ¥çœ‹ä»£ç 

## Tinaå…¥é—¨

Tinaæ˜¯ä¸€ä¸ªéä¾µå…¥æ€§çš„åº“ï¼Œä½ å¯ä»¥ç”¨å®ƒä¸ºä½ çš„ç½‘ç«™æ·»åŠ ç¼–è¾‘åŠŸèƒ½ã€‚æ‰€æœ‰çš„**é¡µé¢ç”Ÿæˆé€»è¾‘å¯ä»¥ä¿æŒå®Œå…¨ä¸å˜**ï¼Œè¿™ä½¿å¾—â€œæ’å…¥â€åŠ¨æ€å†…å®¹ç¼–è¾‘å˜å¾—æ›´å®¹æ˜“ã€‚

ä½ éœ€è¦å®‰è£…å¹¶æ³¨å†Œä¸€ç³»åˆ—æ’ä»¶åˆ°Gatsbyä¸­ï¼Œä»¥ä¾¿å°†Tinaæ·»åŠ åˆ°ä½ çš„ç½‘ç«™ã€‚è®©æˆ‘ä»¬ç°åœ¨å°±æ¥åšè¿™ä»¶äº‹ã€‚

### å®‰è£…Tina

åƒJavaScriptä¸–ç•Œä¸­çš„å¤§å¤šæ•°ä¸œè¥¿ä¸€æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨`npm`æˆ–`yarn`å®‰è£…æˆ‘ä»¬éœ€è¦çš„åŒ…ã€‚ä½¿ç”¨ä¸ä½ çš„é¡¹ç›®ç›¸å…³çš„åŒ…ç®¡ç†å™¨ã€‚

```bash
# ä½¿ç”¨npm
npm i --save gatsby-plugin-tinacms gatsby-tinacms-git gatsby-tinacms-remark styled-components

# æˆ–ä½¿ç”¨Yarn
yarn add gatsby-plugin-tinacms gatsby-tinacms-git gatsby-tinacms-remark styled-components
```

æ­¤å‘½ä»¤æ·»åŠ äº†Tinaæœ¬èº«çš„Gatsbyæ’ä»¶ï¼Œä»¥ä¾¿ä¸Gitæ¥å£ï¼Œå¹¶æ”¯æŒMarkdownæ–‡ä»¶ï¼ˆé€šè¿‡Remarkï¼‰ã€‚ç”±äº*Tyra*å·²ç»å®‰è£…äº†`gatsby-transformer-remark`æ’ä»¶å’Œæ‰€æœ‰ç›¸å…³ä¾èµ–é¡¹ï¼Œæˆ‘åªéœ€è¦å®‰è£…ç‰¹å®šäºTinaCMSçš„æ’ä»¶ã€‚

å¦‚æœä½ æ˜¯ä»å¤´å¼€å§‹ï¼Œä½ éœ€è¦å®‰è£…ç”¨äºåŠ è½½Markdownæ–‡ä»¶çš„Gatsbyæ’ä»¶ã€‚[Gatsbyæ–‡æ¡£](https://www.gatsbyjs.org/docs/adding-markdown-pages/)æœ‰ä¸€ä¸ªå…³äºåœ¨Gatsbyä¸­ä½¿ç”¨Markdownçš„ä¼˜ç§€æŒ‡å—ï¼

### é…ç½®Tina

è¦åœ¨Gatsbyä¸­æ·»åŠ æ–°çš„æˆ–å¤æ‚çš„åŠŸèƒ½ï¼Œä½ å¯ä»¥ä½¿ç”¨æ’ä»¶ã€‚Tinaåœ¨è¿™æ–¹é¢æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚æˆ‘ä»¬éœ€è¦åœ¨`gatsby-config.js`æ–‡ä»¶ä¸­ä¸ºTinaæ·»åŠ ç›¸å…³æ¡ç›®ã€‚

```javascript
# gatsby-config.js

module.exports = {
  siteMetadata: {
    // ...çœç•¥
  },
  plugins: [
    {
      resolve: `gatsby-plugin-tinacms`,
      options: {
        plugins: [
          `gatsby-tinacms-git`,
          `gatsby-tinacms-remark`,
        ],
      },
    },
    // ... å…¶ä»–æ’ä»¶åœ¨ä¸‹é¢ï¼ï¼
  ]
}
```

*Tyra*ä½¿ç”¨Markdownä½œä¸ºå†…å®¹ï¼Œä½†TinaCMSä¹Ÿé€šè¿‡[gatsby-tinacms-json](/docs/guides/converting-gatsby-to-tina)æ”¯æŒJSONæ–‡ä»¶ã€‚æˆ‘å‘ç°JSONéå¸¸é€‚åˆé¡µé¢å†…å®¹å’Œ[å—](https://tinacms.org/blog/what-are-blocks/)ã€‚ä½†å¯¹äºç®€å•çš„åšå®¢æ–‡ç« ï¼ŒMarkdownæ•ˆæœå¾ˆå¥½ã€‚

ç”±äº*Tyra*çš„å†…å®¹æ˜¯åŸºäºGitçš„ï¼Œæ‰€æœ‰çš„ç¼–è¾‘éƒ½éœ€è¦æäº¤å›å­˜å‚¨åº“ã€‚`gatsby-tinacms-git`è·Ÿè¸ªå†…å®¹æ›´æ”¹å¹¶å¤„ç†æ–°æäº¤çš„åˆ›å»ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œæ›´æ”¹ä¼šæ¨é€åˆ°è¿œç¨‹åˆ†æ”¯ï¼Œä½†æ’ä»¶æ˜¯å¯é…ç½®çš„ã€‚

## Tinaé©±åŠ¨çš„ç¼–è¾‘

åœ¨*Tyra Starter*ä¸­ï¼ŒåŠŸèƒ½æ€§`Post`æ¨¡æ¿åˆ›å»ºäº†æ‰€æœ‰åšå®¢æ–‡ç« ã€‚`Post`æ¸²æŸ“Markdownå†…å®¹ã€ä»¥SEOä¸ºé‡ç‚¹çš„å…ƒæ•°æ®ä»¥åŠæ¯ç¯‡æ–‡ç« çš„ä¸»å›¾ã€‚

ä¸ºäº†å¯ç”¨ç¼–è¾‘ï¼Œæˆ‘ä»¬å¯ä»¥å°†`Post`ç»„ä»¶åŒ…è£…åœ¨Tinaæä¾›çš„é«˜é˜¶ç»„ä»¶ä¸­â€”â€”`inlineRemarkForm`ã€‚

è¿™å°±æ˜¯å®ƒçš„æ ·å­ï¼š

```javascript
// src/blog/post.js

import React from 'react'
import Layout from '../common/layouts'
import Hero from './components/hero.js'
import Body from './components/body.js'
import Seo from './seo.js'
import MetaSeo from '../common/seo'
import { graphql } from 'gatsby'
// æ–°çš„Tinaå¯¼å…¥ï¼
import { inlineRemarkForm } from 'gatsby-tinacms-remark'

const Post = ({ location, data }) => {
  const {
    category,
    date,
    dateOriginal,
    author,
    title,
    slug,
    metaDescription,
  } = data.post.frontmatter
  const content = data.post.html
  return (
    <Layout>
      <Seo
        slug={slug}
        title={title}
        date={dateOriginal}
        description={metaDescription}
        author={author}
        image={data.post.frontmatter.postImage.childImageSharp.original.src}
      />
      <MetaSeo title={title} description={metaDescription} />
      <Hero author={author} date={date} category={category} title={title} />
      <Body
        content={content}
        description={metaDescription}
        image={data.post.frontmatter.postImage.childImageSharp.original.src}
        location={location}
      />
    </Layout>
  )
}

export const query = graphql`
  query($slug: String!) {
    post: markdownRemark(frontmatter: { slug: { eq: $slug } }) {
      html
      frontmatter {
        date(formatString: "MMM Do, YYYY")
        dateOriginal: date
        category
        author
        title
        metaDescription
        slug
        postImage {
          childImageSharp {
            original {
              src
            }
            fluid(maxWidth: 1080) {
              ...GatsbyImageSharpFluid
            }
          }
        }
      }
      # Tinaä½¿ç”¨é¢å¤–çš„ã€ä¸“é—¨çš„æŸ¥è¯¢æ•°æ®ã€‚
      # ä½¿ç”¨æ­¤GraphQLç‰‡æ®µæ·»åŠ æ‰€éœ€çš„æ•°æ®ã€‚
      ...TinaRemark
    }
    date: markdownRemark(frontmatter: { slug: { eq: $slug } }) {
      frontmatter {
        date
      }
    }
  }
`

// ä¼ å…¥è¦åŒ…è£…çš„ç»„ä»¶å’Œé…ç½®å¯¹è±¡
export default inlineRemarkForm(Post, { queryName: 'post' })
```

`inlineRemarkForm`å°†æˆ‘ä»¬çš„`Post`ç»„ä»¶ä½œä¸ºå‚æ•°ï¼Œå¹¶**è¿”å›ä¸€ä¸ªç”¨Tinaç®¡é“åŒ…è£…çš„ç»„ä»¶ã€‚** [é«˜é˜¶ç»„ä»¶](https://reactjs.org/docs/higher-order-components.html)å°†è‡ªå®šä¹‰é€»è¾‘æ³¨å…¥åˆ°ç°æœ‰çš„Reactç»„ä»¶ä¸­ã€‚

åœ¨æˆ‘ä»¬çš„GraphQLæŸ¥è¯¢ä¸­ï¼Œæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªç‰‡æ®µï¼Œ`TinaRemark`ï¼Œå®ƒæå–å‡ºé¢å¤–çš„æ•°æ®ä¾›Tinaç¼–è¾‘æ–‡ä»¶ã€‚æˆ‘è¿˜ä¸ºæˆ‘çš„å¸–å­æ•°æ®ä½¿ç”¨äº†ä¸€ä¸ªéæ ‡å‡†çš„æŸ¥è¯¢åç§°ï¼ˆ`post`ï¼‰ã€‚å¹¸è¿çš„æ˜¯ï¼Œé€šè¿‡å°†é…ç½®å¯¹è±¡ä¼ é€’ç»™`inlineRemarkForm`ï¼Œå¯ä»¥å¾ˆå®¹æ˜“åœ°æ›´æ”¹Tinaä½¿ç”¨çš„æ•°æ®ã€‚

æ­¤æ—¶ï¼Œå¦‚æœæˆ‘ä»¬å¯åŠ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºï¼Œæˆ‘ä»¬å¯ä»¥è·³è½¬åˆ°[localhost:8000](http://localhost:8000/)å¹¶çœ‹åˆ°Tinaæ­£åœ¨å·¥ä½œï¼

```bash
# å¯åŠ¨å¼€å‘æœåŠ¡å™¨
npm start
```

å¯¼èˆªåˆ°åšå®¢æ–‡ç« å¹¶ç‚¹å‡»å·¦ä¸‹è§’çš„â€œé“…ç¬”â€å›¾æ ‡ã€‚Tinaä¾§è¾¹æ åº”è¯¥ä¼šå‡ºç°ï¼Œå¹¶è®©ä½ ç¼–è¾‘ä½ çš„Markdownæ–‡ç« ã€‚

![å“‡å“¦ï¼Markdownç¼–è¾‘æ­£åœ¨å·¥ä½œï¼](/img/blog/gatsby-tina-101/madalyn_blog_1.png)

å¾ˆæ£’å§ï¼Ÿåœ¨è¿™é‡Œï¼Œæˆ‘å°†ä½œè€…ä»â€œJane Doeâ€æ›´æ”¹ä¸ºâ€œMadelyn Eriksenâ€ã€‚æˆ‘ä¹Ÿå¯ä»¥åœ¨Tinaä¾§è¾¹æ ä¸­ä¿å­˜è¿™äº›æ›´æ”¹ã€‚è¿™ä¸ªè¿‡ç¨‹ä¼šåœ¨`git`ä¸­è§¦å‘ä¸€ä¸ªè‡ªåŠ¨æäº¤ï¼Œå¹¶æ¨é€åˆ°è¿œç¨‹åˆ†æ”¯ã€‚

**Tinaä¸Gitçš„äº¤äº’æ˜¯å®Œå…¨å¯é…ç½®çš„ã€‚** å¯ä»¥æ›´æ”¹æäº¤æ¶ˆæ¯ï¼Œç¦ç”¨è‡ªåŠ¨æäº¤ï¼Œç”šè‡³æ›´æ”¹Gitç”¨æˆ·ã€‚

```diff
//gatsby-config.js

module.exports = {
  // ...çœç•¥
  plugins: [
    {
      resolve: `gatsby-plugin-tinacms`,
      options: {
        plugins: [
          `gatsby-tinacms-remark`,
-         `gatsby-tinacms-git`
+         {
+           resolve: `gatsby-tinacms-git`,
+           options: {
+             defaultCommitMessage: `è‡ªå®šä¹‰æäº¤æ¶ˆæ¯`, // æ”¹å˜è¿™ä¸ªï¼
+             pushOnCommit: false,
+           },
+        },
        ],
      },
    },
    // ...çœç•¥
  ],
}
```

### å‹å¥½çš„è¡¨å•å­—æ®µ

ç°åœ¨æˆ‘ä»¬çš„ä¾§è¾¹æ ç¼–è¾‘è¡¨å•â€œè¿˜å¯ä»¥â€ï¼Œä½†è¿˜æœ‰æ”¹è¿›çš„ç©ºé—´ã€‚å¦‚æœè¡¨å•å­—æ®µæ²¡æœ‰æ ‡è®°ä¸º`rawFrontmatter.title`è¿™æ ·çš„ä¸œè¥¿ï¼Œé‚£å°±å¥½å¤šäº†ã€‚æˆ‘ä»¬çš„å†…å®¹ä½œè€…å¯èƒ½ä¸å¤ªæ¬£èµè¿™æ ·çš„æ ‡ç­¾ï¼

è¿˜æœ‰ä¸€äº›*Tyra*ä½¿ç”¨çš„å­—æ®µåº”è¯¥æ˜¯â€œç§æœ‰çš„â€ï¼Œä¸åº”è¯¥åœ¨ä¾§è¾¹æ ä¸­å¯ç¼–è¾‘ã€‚ä¾‹å¦‚ï¼Œç”¨äºè¯†åˆ«å¸–å­çš„`type`å‰ç½®å…ƒæ•°æ®å€¼ã€‚

æˆ‘ä»¬å¯ä»¥é€šè¿‡å°†`FormConfig`å¯¹è±¡ä¼ é€’ç»™Tinaæ¥é…ç½®ä¾§è¾¹æ è¡¨å•ã€‚[ä½¿ç”¨Tinaè‡ªå®šä¹‰è¡¨å•](/docs/guides/converting-gatsby-to-tina)å¾ˆç®€å•ã€‚æˆ‘ä»¬éœ€è¦å®šä¹‰ä¸€ä¸ªJavaScriptå¯¹è±¡æ¥å£°æ˜Tinaè¦æ¸²æŸ“çš„æ‰€éœ€è¡¨å•å­—æ®µã€‚

å›åˆ°`src/blog/post.js`ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ è¿™ä¸ªé…ç½®å¯¹è±¡ï¼š

```js
// ...çœç•¥

const FormConfig = {
  label: `åšå®¢æ–‡ç« `,
  queryName: `post`,
  fields: [
    {
      label: `æ ‡é¢˜`,
      name: `rawFrontmatter.title`,
      description: `ä½ çš„æ–‡ç« æ ‡é¢˜ã€‚`,
      component: `text`, // ä¸€ä¸ªç®€å•çš„æ–‡æœ¬è¾“å…¥
    },
    {
      label: `æ–‡ç« å›¾ç‰‡`,
      name: `rawFrontmatter.postImage`,
      component: `image`,
      // å°†ä¸Šä¼ çš„å›¾åƒè½¬æ¢ä¸ºæ–‡ä»¶è·¯å¾„ã€‚
      parse: filename => `./img/${filename}`,
      // åˆ›å»ºä¸€ä¸ªæ–‡ä»¶è·¯å¾„æ¥é¢„è§ˆç¼©ç•¥å›¾ã€‚
      previewSrc: (formValues, { input }) => {
        const [_, field] = input.name.split('.')
        const node = formValues.frontmatter[field]
        const result = node ? node.childImageSharp.fluid.src : ''
        return result
      },
      uploadDir: () => `/content/posts/img/`,
    },
    {
      label: `ä½œè€…`,
      name: `rawFrontmatter.author`,
      description: `ä½ çš„å…¨åã€‚`,
      component: `text`,
    },
    {
      label: `å‘å¸ƒæ—¥æœŸ`,
      name: `rawFrontmatter.date`,
      description: `ä½ çš„æ–‡ç« çš„å‘å¸ƒæ—¥æœŸã€‚`,
      component: `date`,
      dateFormat: `YYYY-MM-DD`,
      timeFormat: false,
    },
    {
      label: `ç±»åˆ«`,
      name: `rawFrontmatter.category`,
      description: `ä½ çš„æ–‡ç« çš„ç±»åˆ«ã€‚`,
      component: `text`,
    },
    {
      label: `æ–‡ç« URL`,
      name: `rawFrontmatter.slug`,
      description: `ä½ çš„æ–‡ç« å°†æ˜¾ç¤ºçš„URLã€‚`,
      component: `text`,
    },
    {
      label: `SEOæè¿°`,
      name: `rawFrontmatter.metaDescription`,
      description: `ç”¨äºæœç´¢å¼•æ“ç»“æœçš„æè¿°ã€‚`,
      component: `text`,
    },
    {
      label: `å†…å®¹`,
      name: `rawMarkdownContent`,
      description: `åœ¨è¿™é‡Œå†™ä½ çš„åšå®¢æ–‡ç« ï¼`,
      component: `markdown`,
    },
  ],
}

// ä¼ å…¥FormConfig
export default inlineRemarkForm(Post, FormConfig)
```

åœ¨`FormConfig`ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨`text`ã€`markdown`ã€`date`ï¼Œç”šè‡³`image`å­—æ®µæ¥ä½¿æ–‡ç« åˆ›ä½œä½“éªŒæ›´å¥½ã€‚Tinaæœ‰[å¾ˆå¤š](https://tinacms.org/docs/plugins/fields/)å†…ç½®å­—æ®µï¼Œç”šè‡³å…è®¸ä½ [æ·»åŠ è‡ªå·±çš„](https://tinacms.org/docs/plugins/fields/custom-fields)ã€‚

`image`å­—æ®µçš„é…ç½®å¯èƒ½æ¯”è¾ƒæ£˜æ‰‹ã€‚å¯¹äº*æ–‡ç« å›¾ç‰‡*ï¼Œæˆ‘ä»¬éœ€è¦Tinaå¤„ç†å›¾åƒä¸Šä¼ ä»¥åŠæ›´æ–°é¢„è§ˆã€‚è¦é…ç½®ä¸Šä¼ ï¼Œä½ éœ€è¦å£°æ˜ä¸Šä¼ ç›®å½•å¹¶ä»ä¸Šä¼ çš„å›¾åƒä¸­è§£æå‡ºé¢„è§ˆç¼©ç•¥å›¾ã€‚

```javascript
{
  label: `æ–‡ç« å›¾ç‰‡`,
  name: `rawFrontmatter.postImage`,
  component: `image`,
  // å‡½æ•°ç”¨äºè½¬æ¢ä¸Šä¼ çš„å›¾åƒã€‚
  parse: filename => `./img/${filename}`,
  previewSrc: (formValues, { input }) => {
    // åˆ›å»ºä¸€ä¸ªç”¨äºæŸ¥çœ‹é¢„è§ˆçš„å‡½æ•°ã€‚
    const [_, field] = input.name.split(".");
    const node = formValues.frontmatter[field];
    const result = node ? node.childImageSharp.fluid.src : "";
    return result;
  },
  uploadDir: () => `/content/posts/img/`,
}
```

å°†æ‰€æœ‰è¿™äº›æ”¾åœ¨ä¸€èµ·ï¼Œæˆ‘ä»¬çš„ä¾§è¾¹æ çœ‹èµ·æ¥*æ›´*å¸å¼•äººä¸”æ›´æ˜“äºä½¿ç”¨ã€‚

![æˆ‘ä»¬æœ‰ä¸€ä¸ªä¸é”™çš„ä¾§è¾¹æ ï¼](/img/blog/gatsby-tina-101/madalyn_blog_2.png)

> **æ³¨æ„ï¼š** åœ¨ç¼–è¾‘æ—¶ï¼Œå¯èƒ½ä¼šæœ‰ä¸€äº›å­—æ®µæ²¡æœ‰å€¼æˆ–æœªå¡«å†™ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç¡®ä¿ä½ çš„ç½‘ç«™èƒ½å¤Ÿå¤„ç†ç©ºå­—æ®µå€¼è€Œä¸ä¼šâ€œå´©æºƒâ€æ˜¯å¾ˆé‡è¦çš„ã€‚

å³ä½¿æœ‰äº†æ¼‚äº®çš„ä¾§è¾¹æ ï¼Œèƒ½å¤Ÿç›´æ¥åœ¨é¡µé¢ä¸Šç¼–è¾‘å†…å®¹ä¼šæ›´å¥½ã€‚

## å†…è”WYSIWYGç¼–è¾‘

å†…è”ç¼–è¾‘æ„å‘³ç€**ç›´æ¥åœ¨é¡µé¢ä¸Šæ›´æ”¹é¡µé¢å†…å®¹**ã€‚è€Œä¸æ˜¯ä½¿ç”¨ä¸åŒçš„åˆ›ä½œå±å¹•ï¼Œä½ å¯ä»¥ç‚¹å‡»é¡µé¢å¼€å§‹è¿›è¡Œç¼–è¾‘ã€‚è¿™æ˜¯ä¸€ç§ç›´è§‚çš„ç½‘é¡µå†…å®¹ç¼–è¾‘æ–¹å¼ã€‚

å¹¸è¿çš„æ˜¯ï¼ŒTinaæ”¯æŒä½¿ç”¨â€œæ‰€è§å³æ‰€å¾—â€ï¼ˆWYSIWYGï¼‰ç¼–è¾‘å™¨è¿›è¡ŒMarkdownçš„å†…è”ç¼–è¾‘ï¼æ·»åŠ å†…è”ç¼–è¾‘å™¨åªéœ€è¦å¯¹æˆ‘ä»¬çš„Tinaé…ç½®ä»£ç è¿›è¡Œä¸€äº›æ›´æ”¹ã€‚

### æ·»åŠ ç¼–è¾‘å±æ€§

`inlineRemarkForm`ä¼ é€’äº†ä¸¤ä¸ªæˆ‘ä»¬å°šæœªä½¿ç”¨çš„å±æ€§ï¼š`isEditing`å’Œ`setIsEditing`ã€‚ä½ å¯ä»¥**ä½¿ç”¨è¿™äº›å±æ€§åœ¨ä»£ç ä¸­åˆ‡æ¢å’Œè§‚å¯Ÿâ€œç¼–è¾‘æ¨¡å¼â€**ã€‚æˆ‘ä»¬å¯ä»¥ä»å±æ€§ä¸­è®¿é—®è¿™äº›å€¼ï¼š

```js
// src/blog/post.js

// ...çœç•¥
const Post = ({ location, data, isEditing, setIsEditing }) => {
  // ...çœç•¥
}
```

æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç®€å•çš„æŒ‰é’®æ¥åˆ‡æ¢â€œç¼–è¾‘æ¨¡å¼â€ï¼Œè¯¥æŒ‰é’®æ˜¾ç¤ºåœ¨æ–‡ç« çš„æ­£ä¸Šæ–¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåˆ‡æ¢å¯ä»¥æ˜¯ä»»ä½•ä½ æƒ³è¦çš„ä¸œè¥¿ï¼æ›´é«˜çº§çš„é€‰é¡¹å¯èƒ½çœ‹èµ·æ¥åƒæ˜¯ä½¿ç”¨[React Portals](https://reactjs.org/docs/portals.html)åœ¨DOMçš„å…¶ä»–åœ°æ–¹æ¸²æŸ“æŒ‰é’®ï¼Œæˆ–è€…ç›‘å¬ç‚¹å‡»æˆ–é”®ç›˜äº‹ä»¶ã€‚

é€šè¿‡æ ‡å‡†çš„â€œå±æ€§ä¼ é€’â€ï¼Œæˆ‘å°†ç¼–è¾‘çŠ¶æ€ä¼ é€’ç»™æˆ‘çš„`Body`ç»„ä»¶ï¼š

```js
// src/blog/post.js

const Post = ({ location, data, isEditing, setIsEditing }) => {
// ...çœç•¥
  return (
    // ...çœç•¥
    <Body
      content={content}
      description={metaDescription}
      image={data.post.frontmatter.postImage.childImageSharp.original.src}
      location={location}
      isEditing={isEditing}
      setIsEditing={setIsEditing}
    />
    // ...çœç•¥
  );
```

åœ¨`Body`ä¸­ï¼Œæˆ‘æ·»åŠ äº†ä¸€ä¸ªä»…åœ¨`development`æ¨¡å¼ä¸‹æ¸²æŸ“çš„æŒ‰é’®ï¼š

```javascript
// src/blog/components/body.js

import React from 'react'
import Sidebar from './sidebar.js'
import Suggested from './suggested.js'

import 'tachyons'

import '../../common/styles/custom.tachyons.css'
import '../styles/grid.css'

const buttonStyles = `
db pv3 ph5 mb3 tracked ttu b bg-dark-gray
near-white sans-serif no-underline
hover-gray b--dark-gray
`

export default ({
  isEditing,
  setIsEditing,
  content,
  image,
  description,
  location,
}) => (
  <div className="min-vh-100 blog__grid">
    <div style={{ gridArea: 'header' }} />
    <section
      className="mw8 serive f4 lh-copy center pa2 article__container"
      style={{ gridArea: 'content' }}
    >
      {/* ä»…åœ¨å¼€å‘æ¨¡å¼ä¸‹æ˜¾ç¤ºç¼–è¾‘æŒ‰é’®ï¼ */}
      {process.env.NODE_ENV === 'development' && (
        <button className={buttonStyles} onClick={() => setIsEditing(p => !p)}>
          {isEditing ? 'é¢„è§ˆ' : 'ç¼–è¾‘'}
        </button>
      )}
      <div dangerouslySetInnerHTML={{ __html: content }} />
    </section>
    <Sidebar img={image} desc={description} location={location} />
    <Suggested />
  </div>
)
```

è¿™å¢åŠ äº†ä¸€ä¸ªå¤§æŒ‰é’®ï¼Œä¾›æˆ‘ä»¬çš„å†…å®¹ä½œè€…ç”¨æ¥æ‰“å¼€ç¼–è¾‘å™¨ã€‚åœ¨é¡µé¢ä¸Šï¼Œå®ƒæœ€ç»ˆçœ‹èµ·æ¥åƒè¿™æ ·ï¼š

![](/img/blog/gatsby-tina-101/madalyn_blog_3.png)

å¾ˆæ•´æ´ï¼ç°åœ¨æˆ‘ä»¬å·²ç»é…ç½®äº†ç¼–è¾‘æ¨¡å¼ï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ å†…è”ç¼–è¾‘æ”¯æŒæœ¬èº«ã€‚

### æ·»åŠ å†…è”ç¼–è¾‘

ç°åœ¨æ˜¯å¤æ‚çš„éƒ¨åˆ†â€”â€”æ·»åŠ å†…è”ç¼–è¾‘ã€‚æˆ‘è¯´å¤æ‚äº†å—ï¼Ÿå®é™…ä¸Šåªéœ€è¦å››è¡Œä»£ç ï¼ğŸ¥³

```javascript
// src/blog/components/body.js

// ...çœç•¥

import { Wysiwyg } from '@tinacms/fields'
import { TinaField } from '@tinacms/form-builder'

export default (
  {
    // ...çœç•¥
  }
) => (
  <div className="min-vh-100 blog__grid">
    <div style={{ gridArea: 'header' }} />
    <section
      className="mw8 serive f4 lh-copy center pa2 article__container"
      style={{ gridArea: 'content' }}
    >
      {process.env.NODE_ENV === 'development' && (
        <button className={buttonStyles} onClick={() => setIsEditing(p => !p)}>
          {isEditing ? 'é¢„è§ˆ' : 'ç¼–è¾‘'}
        </button>
      )}
      {/* ç”¨WYSIWYGç¼–è¾‘å™¨åŒ…è£…å†…å®¹ */}
      <TinaField name="rawMarkdownBody" Component={Wysiwyg}>
        <div dangerouslySetInnerHTML={{ __html: content }} />
      </TinaField>
    </section>
    <Sidebar img={image} desc={description} location={location} />
    <Suggested />
  </div>
)
```

åœ¨æ·»åŠ å†…è”ç¼–è¾‘å™¨ä¹‹å‰ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªæ¸²æŸ“å†…éƒ¨HTMLçš„`div`ã€‚è¦å°†å…¶è½¬æ¢ä¸ºWYSIWYGç¼–è¾‘å™¨ï¼Œæˆ‘ä»¬åªéœ€å°†å…¶åŒ…è£…åœ¨`TinaField`ç»„ä»¶ä¸­ï¼š

```javascript
<TinaField name="rawMarkdownBody" Component={Wysiwyg}>
  <div dangerouslySetInnerHTML={{ __html: content }} />
</TinaField>
```

ç”±äºå®ƒåŒ…è£…çš„æ˜¯Markdownæ­£æ–‡ï¼Œæˆ‘ä»¬å°†`name`å±æ€§èµ‹å€¼ä¸º`rawMarkdownBody`ã€‚ä¸ºäº†æ¸²æŸ“WYSIWYGç¼–è¾‘å™¨ï¼Œæˆ‘ä»¬å°†`@tinacms/fields`ä¸­çš„`Wysiwyg`ç»„ä»¶ä½œä¸ºå±æ€§ä¼ é€’ã€‚**Tinaåœ¨â€œç¼–è¾‘æ¨¡å¼â€æ¿€æ´»æ—¶æ¸²æŸ“æ­¤ç»„ä»¶ã€‚**

å½“ç„¶ï¼Œæˆ‘ä»¬è¿˜å¿…é¡»å¯¼å…¥ç›¸å…³çš„Tinaç»„ä»¶æ‰èƒ½*ä½¿ç”¨*å®ƒä»¬ï¼š

```javascript
import { Wysiwyg } from '@tinacms/fields'
import { TinaField } from '@tinacms/form-builder'
```

æ·»åŠ è¿™äº›ä»£ç ç‰‡æ®µåï¼Œæˆ‘ä»¬å®é™…ä¸Šå¯ä»¥ä½¿ç”¨å†…è”ç¼–è¾‘å™¨æ¥æ›´æ”¹åšå®¢æ–‡ç« ï¼

![å“‡å“¦ï¼è¿™çœŸæ˜¯å¤ªæ£’äº†ã€‚](/img/blog/gatsby-tina-101/madalyn_blog_4.png)

ä¸ºäº†å®Œæˆæˆ‘ä»¬çš„ç¼–è¾‘ä½“éªŒï¼Œæˆ‘ä»¬çœŸæ­£éœ€è¦çš„æ˜¯èƒ½å¤Ÿä½¿ç”¨Tinaæ·»åŠ æ–°æ–‡ç« ï¼

## åˆ›ä½œæ–°æ–‡ç« 

Tinaæœ‰ä¸€ç§ç”¨äºåˆ›å»ºå†…å®¹çš„æ’ä»¶ï¼Œæ°å½“åœ°å‘½åä¸º[å†…å®¹åˆ›å»ºè€…æ’ä»¶](/docs/plugins/content-creators)ã€‚å†…å®¹åˆ›å»ºè€…å°±åƒåˆ›å»ºæ–‡ä»¶å¯¹è±¡çš„å·¥å‚ï¼Œé™¤äº†å®ƒä»¬æ˜¯â€œæ’å…¥â€åˆ°ä½ çš„Reactç½‘ç«™ä¸­çš„ã€‚

è®©æˆ‘ä»¬åˆ¶ä½œä¸€ä¸ª*å†…å®¹åˆ›å»ºè€…æ’ä»¶*æ¥åˆ›ä½œæ–°çš„åšå®¢æ–‡ç« ã€‚æˆ‘ä»¬å°†åœ¨ä¸€ä¸ªåä¸ºâ€œpluginsâ€çš„æ–°ç›®å½•ä¸­æ·»åŠ å®ƒâ€”â€”`src/blog/plugins/postCreator.js`ï¼š

```javascript
// src/blog/plugins/postCreator.js

import { RemarkCreatorPlugin } from 'gatsby-tinacms-remark'

// å°†URL slugè½¬æ¢ä¸ºæ–‡ä»¶å
const slugToFilename = str => str.replace(`/`, `-`) + `.md`

// å°†æ—¥æœŸè½¬æ¢ä¸ºYYYY-MM-DDæ ¼å¼çš„å­—ç¬¦ä¸²
const YYYYMMDD = date => date.toISOString().split('T')[0]

const defaultFrontmatter = form => ({
  title: form.title,
  slug: form.slug,
  author: form.author,
  category: form.category,
  date: YYYYMMDD(new Date()),
  postImage: `./img/flatlay.jpg`,
  metaDescription: ``,
  type: `post`,
})

const CreatePostPlugin = new RemarkCreatorPlugin({
  label: `æ–°åšå®¢æ–‡ç« `,
  filename: form => `content/posts/${slugToFilename(form.slug)}`,
  frontmatter: defaultFrontmatter,
  fields: [
    {
      label: `æ ‡é¢˜`,
      name: `title`,
      description: `ä½ çš„æ–‡ç« æ ‡é¢˜ã€‚`,
      component: `text`,
    },
    {
      label: `ä½œè€…`,
      name: `author`,
      description: `ä½ çš„å…¨åã€‚`,
      component: `text`,
    },
    {
      label: `ç±»åˆ«`,
      name: `category`,
      description: `ä½ çš„æ–‡ç« çš„ç±»åˆ«ã€‚`,
      component: `text`,
    },
    {
      label: `æ–‡ç« URL`,
      name: `slug`,
      description: `ä½ çš„æ–‡ç« å°†æ˜¾ç¤ºçš„URLã€‚`,
      component: `text`,
    },
  ],
})

export default CreatePostPlugin
```

`gatsby-tinacms-remark`